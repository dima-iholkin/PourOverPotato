var O=Object.defineProperty;var W=(t,e,n)=>e in t?O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var s=(t,e,n)=>(W(t,typeof e!="symbol"?e+"":e,n),n);class E{constructor(e){s(this,"id");s(this,"name");s(this,"description");this.id=e.id,this.name=e.name,this.description=e.description}static hasValidName(e){return e.name.trim().length<3?"ValidationFailed_NameMustBeAtLeast3CharsLong":!0}}class N{constructor(e){s(this,"name");s(this,"description");this.name=e.name,this.description=e.description}static create(e){if(E.hasValidName(e)==="ValidationFailed_NameMustBeAtLeast3CharsLong")return"ValidationFailed_NameMustBeAtLeast3CharsLong";const n=e.name.trim(),o=e.description.trim(),r={name:n,description:o};return new N(r)}}class R{constructor(e){s(this,"id");s(this,"name");s(this,"description");this.id=e.id,this.name=e.name,this.description=e.description}static create(e){if(E.hasValidName(e)==="ValidationFailed_NameMustBeAtLeast3CharsLong")return"ValidationFailed_NameMustBeAtLeast3CharsLong";const n=e.name.trim(),o=e.description.trim(),r={id:e.id,name:n,description:o};return new R(r)}}const D=(t,e)=>e.some(n=>t instanceof n);let C,S;function _(){return C||(C=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function x(){return S||(S=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const w=new WeakMap,g=new WeakMap,l=new WeakMap;function k(t){const e=new Promise((n,o)=>{const r=()=>{t.removeEventListener("success",a),t.removeEventListener("error",i)},a=()=>{n(f(t.result)),r()},i=()=>{o(t.error),r()};t.addEventListener("success",a),t.addEventListener("error",i)});return l.set(e,t),e}function K(t){if(w.has(t))return;const e=new Promise((n,o)=>{const r=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",i),t.removeEventListener("abort",i)},a=()=>{n(),r()},i=()=>{o(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",a),t.addEventListener("error",i),t.addEventListener("abort",i)});w.set(t,e)}let I={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return w.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function j(t){I=t(I)}function q(t){return x().includes(t)?function(...e){return t.apply(B(this),e),f(this.request)}:function(...e){return f(t.apply(B(this),e))}}function z(t){return typeof t=="function"?q(t):(t instanceof IDBTransaction&&K(t),D(t,_())?new Proxy(t,I):t)}function f(t){if(t instanceof IDBRequest)return k(t);if(g.has(t))return g.get(t);const e=z(t);return e!==t&&(g.set(t,e),l.set(e,t)),e}const B=t=>l.get(t);function X(t,e,{blocked:n,upgrade:o,blocking:r,terminated:a}={}){const i=indexedDB.open(t,e),d=f(i);return o&&i.addEventListener("upgradeneeded",c=>{o(f(i.result),c.oldVersion,c.newVersion,f(i.transaction),c)}),n&&i.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),d.then(c=>{a&&c.addEventListener("close",()=>a()),r&&c.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),d}const U=["get","getKey","getAll","getAllKeys","count"],$=["put","add","delete","clear"],p=new Map;function L(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(p.get(e))return p.get(e);const n=e.replace(/FromIndex$/,""),o=e!==n,r=$.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!(r||U.includes(n)))return;const a=async function(i,...d){const c=this.transaction(i,r?"readwrite":"readonly");let u=c.store;return o&&(u=u.index(d.shift())),(await Promise.all([u[n](...d),r&&c.done]))[0]};return p.set(e,a),a}j(t=>({...t,get:(e,n,o)=>L(e,n)||t.get(e,n,o),has:(e,n)=>!!L(e,n)||t.has(e,n)}));const G=["continue","continuePrimaryKey","advance"],b={},y=new WeakMap,F=new WeakMap,H={get(t,e){if(!G.includes(e))return t[e];let n=b[e];return n||(n=b[e]=function(...o){y.set(this,F.get(this)[e](...o))}),n}};async function*J(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,H);for(F.set(n,e),l.set(n,B(e));e;)yield n,e=await(y.get(n)||e.continue()),y.delete(n)}function M(t,e){return e===Symbol.asyncIterator&&D(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&D(t,[IDBIndex,IDBObjectStore])}j(t=>({...t,get(e,n,o){return M(e,n)?J:t.get(e,n,o)},has(e,n){return M(e,n)||t.has(e,n)}}));class Q{constructor(e){s(this,"id");s(this,"coffeeBeansId");s(this,"recipeTarget");s(this,"recipeResult");s(this,"recipeThoughts");s(this,"favorite");s(this,"rating");s(this,"outWeight");s(this,"timestamp");this.id=e.id,this.coffeeBeansId=e.coffeeBeansId,this.recipeTarget=e.recipeTarget,this.recipeResult=e.recipeResult,this.recipeThoughts=e.recipeThoughts,this.favorite=e.favorite,this.rating=e.rating,this.outWeight=e.outWeight,this.timestamp=e.timestamp}}class T{constructor(e){s(this,"id");s(this,"coffeeBeansId");s(this,"recipeTarget");s(this,"recipeResult");s(this,"recipeThoughts");s(this,"favorite");s(this,"rating");s(this,"outWeight");s(this,"timestamp");s(this,"softDeleted");this.id=e.id,this.coffeeBeansId=e.coffeeBeansId,this.recipeTarget=e.recipeTarget,this.recipeResult=e.recipeResult,this.recipeThoughts=e.recipeThoughts,this.favorite=e.favorite??!1,this.rating=e.rating,this.outWeight=e.outWeight,this.timestamp=e.timestamp,this.softDeleted=e.softDeleted??!1}static fromRecipe(e){const n={...e,timestamp:e.timestamp.getTime(),softDeleted:!1};return new T(n)}toRecipe(){const e={...this,favorite:this.favorite??!1,timestamp:new Date(this.timestamp)};return new Q(e)}}class se{constructor(e){s(this,"coffeeBeansId");s(this,"recipeTarget");s(this,"recipeResult");s(this,"recipeThoughts");s(this,"favorite");s(this,"rating");s(this,"outWeight");s(this,"timestamp");s(this,"softDeleted");this.coffeeBeansId=e.coffeeBeansId,this.recipeTarget=e.recipeTarget,this.recipeResult=e.recipeResult,this.recipeThoughts=e.recipeThoughts,this.favorite=e.favorite??!1,this.rating=e.rating,this.outWeight=e.outWeight,this.timestamp=e.timestamp.getTime(),this.softDeleted=!1}toRecipeDB(e,n){return new T({...e,id:n})}}const Y="entities",Z=2,h="coffeeBeans",V="nameLowerCase",m="recipes",A="coffeeBeansId";async function oe(){return await X(Y,Z,{async upgrade(t,e,n,o){switch(e){case 0:v(t);break;case 1:{v(t),await te(t,o),await ee(t,o);break}}}})}function v(t){if(t.objectStoreNames.contains(h)===!1&&t.createObjectStore(h,{keyPath:"id",autoIncrement:!0}).createIndex(V,V,{unique:!0}),t.objectStoreNames.contains(m)===!1){const e=t.createObjectStore(m,{keyPath:"id",autoIncrement:!0});e.createIndex(A,A,{unique:!1}),e.createIndex("outWeight","outWeight",{unique:!1}),e.createIndex("rating","rating",{unique:!1}),e.createIndex("timestamp","timestamp",{unique:!1})}}async function ee(t,e){const n=await e.objectStore(h).getAll();for(const o of n){const r={...o,softDeleted:!1};await e.objectStore(h).put(r)}}async function te(t,e){const n=await e.objectStore(m).getAll();for(const o of n){const r={...o,favorite:!1,timestamp:o.timestamp.getTime(),softDeleted:!1};await e.objectStore(m).put(r)}}class P{constructor(e){s(this,"id");s(this,"name");s(this,"description");s(this,"nameLowerCase");s(this,"softDeleted");this.id=e.id,this.name=e.name,this.description=e.description,this.nameLowerCase=e.nameLowerCase,this.softDeleted=e.softDeleted}static fromCoffeeBeans(e){const n={...e,nameLowerCase:e.name.toLowerCase(),softDeleted:!1};return new P(n)}toCoffeeBeans(){return new E(this)}}class re{constructor(e){s(this,"name");s(this,"description");s(this,"nameLowerCase");s(this,"softDeleted");this.name=e.name,this.description=e.description,this.nameLowerCase=e.name.toLowerCase(),this.softDeleted=!1}}function ie(t){const e=new CustomEvent("addToast",{detail:{message:t,timeout:5e3}});document.dispatchEvent(e)}function ae(t,e,n){const o=new CustomEvent("addToast",{detail:{message:t,timeout:1e4,onClickUndo:e,onUndoIgnored:n}});document.dispatchEvent(o)}function ce(t){const e=Math.floor((Date.now()-t.getTime())/1e3);if(Math.floor(e/86400)>=1){const a=new Date;return a.setDate(a.getDate()-1),a.toDateString()===t.toDateString()?"yesterday":t.toLocaleString(void 0,{dateStyle:"short"})}const o=Math.floor(e/3600);if(o>1)return o+" hours ago";if(o===1)return"1 hour ago";const r=Math.floor(e/60);return r>1?r+" minutes ago":"just now"}function ue(t){const e=t.getTimezoneOffset()*6e4;return new Date(t.getTime()-e).toISOString().slice(0,-8)}function fe(t){const e=Date.parse(t);return new Date(e)}export{h as C,m as R,ie as a,P as b,V as c,A as d,E as e,re as f,Q as g,ue as h,ae as i,se as j,T as k,R as l,ce as m,N as n,oe as o,fe as p};
