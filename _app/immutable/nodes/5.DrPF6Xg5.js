import{s as Q,b as Me,a as je,n as k,r as He,o as qe}from"../chunks/scheduler.Cw1-ZcKD.js";import{S as X,i as Z,v as Le,e as v,s as g,k as U,c as b,a as S,y as $,f as C,d as f,m as G,z as h,g as d,h as x,n as z,A as K,q as J,o as W,r as Y,t as ve,b as be,E as _e,w as Fe,j as Ue,l as Ge}from"../chunks/index.DHsbL8_X.js";import{v as Se}from"../chunks/entry.D9J3zD_q.js";import{d as ze,v as Je,a as We}from"../chunks/manageData.DdInJ4k0.js";import{D as Ye}from"../chunks/DeleteConfirmationModal.C0krRx71.js";import{a as ne,e as Ee,g as Ke,o as Ve,C as ee,R as te,b as Oe,j as Ae,E as Qe,f as Xe,i as Ze,n as et}from"../chunks/toastProvider.CA3wvqVI.js";import{p as tt}from"../chunks/dateHelpers.BAQsHIds.js";function at(n){let e;return{c(){e=ve("Please confirm you want to delete all your data.")},l(t){e=be(t,"Please confirm you want to delete all your data.")},m(t,o){d(t,e,o)},d(t){t&&f(e)}}}function nt(n){let e,t,o="Delete all data:",i,a,p="Delete all data",c,r,l,u,w,E;function T(_){n[3](_)}let y={onDeleteClick:n[1],$$slots:{default:[at]},$$scope:{ctx:n}};return n[0]!==void 0&&(y.setModalState=n[0]),r=new Ye({props:y}),Me.push(()=>Le(r,"setModalState",T)),{c(){e=v("div"),t=v("p"),t.textContent=o,i=g(),a=v("button"),a.textContent=p,c=g(),U(r.$$.fragment),this.h()},l(_){e=b(_,"DIV",{class:!0});var I=S(e);t=b(I,"P",{"data-svelte-h":!0}),$(t)!=="svelte-15f4b12"&&(t.textContent=o),i=C(I),a=b(I,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),$(a)!=="svelte-14fbba6"&&(a.textContent=p),I.forEach(f),c=C(_),G(r.$$.fragment,_),this.h()},h(){h(a,"class","button-delete svelte-sr1t9x"),h(a,"type","button"),h(e,"class","container svelte-sr1t9x")},m(_,I){d(_,e,I),x(e,t),x(e,i),x(e,a),d(_,c,I),z(r,_,I),u=!0,w||(E=K(a,"click",n[2]),w=!0)},p(_,[I]){const D={};I&16&&(D.$$scope={dirty:I,ctx:_}),!l&&I&1&&(l=!0,D.setModalState=_[0],je(()=>l=!1)),r.$set(D)},i(_){u||(J(r.$$.fragment,_),u=!0)},o(_){W(r.$$.fragment,_),u=!1},d(_){_&&(f(e),f(c)),Y(r,_),w=!1,E()}}}function st(n,e,t){let o;async function i(){await ze(),ne("All data deleted.")}const a=()=>o("open");function p(c){o=c,t(0,o)}return[o,i,a,p]}class ot extends X{constructor(e){super(),Z(this,e,st,nt,Q,{})}}function it(n){let e,t,o="Add a toast",i,a,p="Add a long toast",c,r;return{c(){e=v("div"),t=v("button"),t.textContent=o,i=g(),a=v("button"),a.textContent=p,this.h()},l(l){e=b(l,"DIV",{class:!0});var u=S(e);t=b(u,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),$(t)!=="svelte-1knn3yw"&&(t.textContent=o),i=C(u),a=b(u,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),$(a)!=="svelte-1uk1clz"&&(a.textContent=p),u.forEach(f),this.h()},h(){h(t,"type","button"),h(t,"class","svelte-aygdid"),h(a,"type","button"),h(a,"class","svelte-aygdid"),h(e,"class","container svelte-aygdid")},m(l,u){d(l,e,u),x(e,t),x(e,i),x(e,a),c||(r=[K(t,"click",n[0]),K(a,"click",n[1])],c=!0)},p:k,i:k,o:k,d(l){l&&f(e),c=!1,He(r)}}}function rt(n){return[()=>ne("Ethiopia Gesha"),()=>ne("Ethiopia Yirgacheffe Rwanda Mabanza Kenya Kegwa Colombia El Refugio Guatemala Cafe De Mujeres")]}class lt extends X{constructor(e){super(),Z(this,e,rt,it,Q,{})}}function ct(n,e,t){const o=[];for(const i of n){const a=e.find(p=>p.name.toLowerCase()===i.name.toLowerCase());a?t.set(i.id,a.id):o.push(i)}return o}function ft(n,e){const t=[];for(const o of n)e.find(a=>a.timestamp.getTime()===o.timestamp.getTime()&&a.outWeight===o.outWeight&&a.rating===o.rating&&a.recipeTarget===o.recipeTarget&&a.recipeResult===o.recipeResult&&a.recipeThoughts===o.recipeThoughts&&a.coffeeBeansId===o.coffeeBeansId&&a.favorite===o.favorite)||t.push(o);return t}function B(n){return n==null}function Pe(n){return n!=null}function Ie(n){return!(B(n)||Number.isInteger(n)===!1||n<0)}function ut(n){return B(n)||typeof n!="boolean"?!1:n}function pt(n,e){if(B(n))return alert('"dbVersion" property not found in the file. Import aborted.'),"ImportFailed";if(Number.isInteger(n)===!1)return alert('"dbVersion" property must be an integer. Import aborted.'),"ImportFailed";const t=n;return t<=0?(alert(`The file's "dbVersion" must be higher than 0. Import aborted.`),"ImportFailed"):t>e?(alert(`The file's "dbVersion" = ${n} is higher than the app's current "dbVersion" = ${e}.
       Import aborted. Try refreshing the page and importing again. If the problem persists, please contact the
       developer.`),"ImportFailed"):t}function Ne(n){return B(n)||Number.isFinite(n)===!1||n<0?0:n}function ae(n){return B(n)||typeof n!="string"?"":n}function dt(n){if(B(n)||typeof n!="string")return"ImportFailed";const e=tt(n);return e.toString()==="Invalid Date"?"ImportFailed":e}function mt(n){if(B(n))return"ImportFailed";const e=n;if(Ie(e.id)===!1)return"ImportFailed";const o=e.id,i=ae(e.name);if(Ee.hasValidName({name:i})==="ValidationFailed_NameMustBeAtLeast3CharsLong")return alert(`Imported CoffeeBeans name must be at least 3 characters long. Faulty item:
`+JSON.stringify(e,null,2)),"ImportFailed";const a=ae(e.description),p={id:o,name:i,description:a};return new Ee(p)}function ht(n){if(B(n)||Array.isArray(n)===!1)return alert('"coffeeBeans" array not found in the file.'),"ImportFailed";const e=n,t=[];for(const o of e){const i=mt(o);if(i==="ImportFailed")return"ImportFailed";t.push(i)}return t}function vt(n,e){if(B(n))return"ImportFailed";const t=n;if(Ie(t.id)===!1)return"ImportFailed";const i=t.id,a=ae(t.recipeTarget),p=ae(t.recipeResult),c=ae(t.recipeThoughts),r=Ne(t.outWeight),l=Ne(t.rating),u=ut(t.favorite),w=dt(t.timestamp);if(w==="ImportFailed"||Ie(t.coffeeBeansId)===!1)return"ImportFailed";if(e.has(t.coffeeBeansId)===!1){const I=`Import aborted because of an internal error. Unable to match the "CoffeeBeansId" from Recipe
       ${JSON.stringify(t)}. Please inform the developer.`;return console.error(I),"ImportFailed"}const T=e.get(t.coffeeBeansId),y={id:i,coffeeBeansId:T,recipeTarget:a,recipeResult:p,recipeThoughts:c,favorite:u,rating:l,outWeight:r,timestamp:w};return new Ke(y)}function bt(n,e){if(B(n)||Array.isArray(n)===!1)return alert('"recipes" array not found in the file.'),"ImportFailed";const t=[];for(const o of n){const i=vt(o,e);if(i==="ImportFailed")return"ImportFailed";t.push(i)}return t}async function _t(){const e=(await Ve()).transaction([ee,te],"readonly"),t=await e.objectStore(ee).getAll(),o=await e.objectStore(te).getAll(),i=e.db.version;await e.done;const a=t.filter(l=>l.softDeletionTimestamp===void 0).map(l=>new Oe(l).toCoffeeBeans()),p=o.filter(l=>l.softDeletionTimestamp===void 0).map(l=>new Ae(l).toRecipe()),r=JSON.stringify({dbVersion:i,coffeeBeans:a,recipes:p});return new Blob([r],{type:"application/json"})}async function gt(n){const e=JSON.parse(await n.text()),o=(await Ve()).transaction([ee,te,Qe],"readwrite");if(await Je(o),await We(o),pt(e.dbVersion,o.db.version)==="ImportFailed")return o.abort(),"ImportFailed";const a=new Map,p=ht(e.coffeeBeans);if(p==="ImportFailed")return o.abort(),"ImportFailed";const r=(await o.objectStore(ee).getAll()).map(y=>new Oe(y).toCoffeeBeans()),l=ct(p,r,a);for(const y of l){const _=new Xe(y),I=await o.objectStore(ee).add(_);a.set(y.id,I)}const u=bt(e.recipes,a);if(u==="ImportFailed")return o.abort(),"ImportFailed";const E=(await o.objectStore(te).getAll()).map(y=>new Ae(y).toRecipe()),T=ft(u,E);for(const y of T){const _=new Ze(y);await o.objectStore(te).add(_)}return await et(o),await o.done,{coffeeBeansCount:l.length,recipesCount:T.length}}function Ct(n){let e,t,o="Export all data:",i,a,p="Export to file",c,r;return{c(){e=v("div"),t=v("p"),t.textContent=o,i=g(),a=v("button"),a.textContent=p,this.h()},l(l){e=b(l,"DIV",{class:!0});var u=S(e);t=b(u,"P",{style:!0,"data-svelte-h":!0}),$(t)!=="svelte-6a1m9a"&&(t.textContent=o),i=C(u),a=b(u,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),$(a)!=="svelte-1rmfvr0"&&(a.textContent=p),u.forEach(f),this.h()},h(){_e(t,"margin-right","0.5rem"),h(a,"type","button"),h(a,"class","svelte-1avwjxk"),h(e,"class","container svelte-1avwjxk")},m(l,u){d(l,e,u),x(e,t),x(e,i),x(e,a),c||(r=K(a,"click",n[0]),c=!0)},p:k,i:k,o:k,d(l){l&&f(e),c=!1,r()}}}function yt(n){async function e(){const t=document.createElement("a"),o=await _t();t.href=URL.createObjectURL(o);const i=new Date,p=(i.getMonth()+1).toString().padStart(2,"0"),r=i.getDate().toString().padStart(2,"0");t.setAttribute("download",`PourOverPotato-${i.getFullYear()}_${p}_${r}.json`),document.body.appendChild(t),t.click(),document.body.removeChild(t)}return[e]}class $t extends X{constructor(e){super(),Z(this,e,yt,Ct,Q,{})}}function It(n){let e,t,o="Import data:",i,a,p="Import from file",c,r;return{c(){e=v("div"),t=v("p"),t.textContent=o,i=g(),a=v("button"),a.textContent=p,this.h()},l(l){e=b(l,"DIV",{class:!0});var u=S(e);t=b(u,"P",{style:!0,"data-svelte-h":!0}),$(t)!=="svelte-1jemb82"&&(t.textContent=o),i=C(u),a=b(u,"BUTTON",{class:!0,"data-svelte-h":!0}),$(a)!=="svelte-1u0f5a8"&&(a.textContent=p),u.forEach(f),this.h()},h(){_e(t,"margin-right","0.5rem"),h(a,"class","svelte-qz8ys4"),h(e,"class","container svelte-qz8ys4")},m(l,u){d(l,e,u),x(e,t),x(e,i),x(e,a),c||(r=K(a,"click",n[0]),c=!0)},p:k,i:k,o:k,d(l){l&&f(e),c=!1,r()}}}function xt(n){async function e(){const t=document.createElement("input");t.type="file",t.onchange=async()=>{if(B(t.files)||B(t.files.item(0))){alert("Please provide a file.");return}if(t.files.length>1){alert("Please provide a single file.");return}const o=t.files.item(0);if(o.type!=="application/json"){alert("Please provide a JSON file.");return}const i=await gt(o);i!=="ImportFailed"&&Pe(i.coffeeBeansCount)&&Pe(i.recipesCount)&&ne(`Imported ${i.coffeeBeansCount} coffee beans and ${i.recipesCount} recipes.`)},t.click()}return[e]}class wt extends X{constructor(e){super(),Z(this,e,xt,It,Q,{})}}function kt(n){let e,t=n[0]?"enabled":"not enabled",o,i,a,p,c=n[0]===!1&&Re(n);return{c(){e=v("p"),o=ve(t),a=g(),c&&c.c(),p=Fe(),this.h()},l(r){e=b(r,"P",{class:!0,style:!0});var l=S(e);o=be(l,t),l.forEach(f),a=C(r),c&&c.l(r),p=Fe(),this.h()},h(){h(e,"class",i=n[0]?"text-green-500":"text-red-700"),_e(e,"font-weight","bold")},m(r,l){d(r,e,l),x(e,o),d(r,a,l),c&&c.m(r,l),d(r,p,l)},p(r,l){l&1&&t!==(t=r[0]?"enabled":"not enabled")&&Ue(o,t),l&1&&i!==(i=r[0]?"text-green-500":"text-red-700")&&h(e,"class",i),r[0]===!1?c?c.p(r,l):(c=Re(r),c.c(),c.m(p.parentNode,p)):c&&(c.d(1),c=null)},d(r){r&&(f(e),f(a),f(p)),c&&c.d(r)}}}function Bt(n){let e,t="loading...";return{c(){e=v("p"),e.textContent=t},l(o){e=b(o,"P",{"data-svelte-h":!0}),$(e)!=="svelte-qeejp2"&&(e.textContent=t)},m(o,i){d(o,e,i)},p:k,d(o){o&&f(e)}}}function Re(n){let e,t="Enable",o,i;return{c(){e=v("button"),e.textContent=t,this.h()},l(a){e=b(a,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),$(e)!=="svelte-105jgsy"&&(e.textContent=t),this.h()},h(){h(e,"type","button"),h(e,"class","svelte-3tnosg")},m(a,p){d(a,e,p),o||(i=K(e,"click",n[1]),o=!0)},p:k,d(a){a&&f(e),o=!1,i()}}}function Tt(n){let e,t,o="Persistent storage:",i,a;function p(l,u){return l[0]===void 0?Bt:kt}let c=p(n),r=c(n);return{c(){e=v("div"),t=v("p"),t.textContent=o,i=g(),a=v("div"),r.c(),this.h()},l(l){e=b(l,"DIV",{class:!0});var u=S(e);t=b(u,"P",{style:!0,"data-svelte-h":!0}),$(t)!=="svelte-1uqq51"&&(t.textContent=o),i=C(u),a=b(u,"DIV",{class:!0,style:!0});var w=S(a);r.l(w),w.forEach(f),u.forEach(f),this.h()},h(){_e(t,"margin-right","0.5rem"),h(a,"class","container-row-nowrap svelte-3tnosg"),h(a,"style",""),h(e,"class","container svelte-3tnosg")},m(l,u){d(l,e,u),x(e,t),x(e,i),x(e,a),r.m(a,null)},p(l,[u]){c===(c=p(l))&&r?r.p(l,u):(r.d(1),r=c(l),r&&(r.c(),r.m(a,null)))},i:k,o:k,d(l){l&&f(e),r.d()}}}function Dt(n,e,t){let o;qe(async()=>{t(0,o=await navigator.storage.persisted())});async function i(){await navigator.storage.persist()==!1?alert(`Sorry, your browser refused to enable persistent storage.
This means your data is still at risk of being evicted by the browser at any moment.
Try using another browser like Firefox, it seems to allow enabling persistent storage always.`):(ne("Persistent storage enabled."),t(0,o=!0))}return[o,i]}class Ft extends X{constructor(e){super(),Z(this,e,Dt,Tt,Q,{})}}function St(n){let e,t,o="About the project",i,a,p=`<p class="svelte-p097pa">This is on an open-source application developed
    <a href="https://github.com/dima-iholkin/PourOverPotato" target="_blank" class="svelte-p097pa">on GitHub</a>.</p> <p class="svelte-p097pa">You can view the development workitems
    <a href="https://github.com/users/dima-iholkin/projects/5/views/1" target="_blank" class="svelte-p097pa">on the Projects page</a>.</p> <p class="svelte-p097pa">You can influence the project using
    <a href="https://github.com/dima-iholkin/PourOverPotato/discussions" target="_blank" class="svelte-p097pa">the Discussions</a> and
    <a href="https://github.com/dima-iholkin/PourOverPotato/issues" target="_blank" class="svelte-p097pa">the Issues</a>
    pages.</p>`,c,r,l="About your data",u,w,E=`<p class="svelte-p097pa">By design all your data is saved in your browser only and on your device only, it&#39;s not sent anywhere, there is no
    server. You can import and export your data to and from a file.</p> <p style="padding-bottom: 1rem;" class="svelte-p097pa">Much later I would like to add an ability to sync data with Google Drive.</p> <p class="svelte-p097pa">The application is in active development. Things may change and data integrity is not guaranteed. However I&#39;ll try
    hard to not break your data.</p>`,T,y,_="Manage your data",I,D,se,A,oe,M,ie,P,xe="Delete your data",re,j,le,N,we="Credits",ce,R,ke=`The coffee beans icon created by
  <a href="https://www.flaticon.com/free-icons/coffee-beans" title="coffee beans icons" class="svelte-p097pa">Freepik - Flaticon</a>`,fe,V,Be="Developer tools",ue,H,pe,O,Te="About the app",de,F,q,ge,Ce,ye,L,De='<a href="https://github.com/dima-iholkin/PourOverPotato/blob/main/CHANGELOG.md" target="_blank" class="svelte-p097pa">CHANGELOG</a>',me;return D=new Ft({}),A=new $t({}),M=new wt({}),j=new ot({}),H=new lt({}),{c(){e=g(),t=v("h5"),t.textContent=o,i=g(),a=v("div"),a.innerHTML=p,c=g(),r=v("h5"),r.textContent=l,u=g(),w=v("div"),w.innerHTML=E,T=g(),y=v("h5"),y.textContent=_,I=g(),U(D.$$.fragment),se=g(),U(A.$$.fragment),oe=g(),U(M.$$.fragment),ie=g(),P=v("h5"),P.textContent=xe,re=g(),U(j.$$.fragment),le=g(),N=v("h5"),N.textContent=we,ce=g(),R=v("p"),R.innerHTML=ke,fe=g(),V=v("h5"),V.textContent=Be,ue=g(),U(H.$$.fragment),pe=g(),O=v("h5"),O.textContent=Te,de=g(),F=v("div"),q=v("p"),ge=ve("Version: "),Ce=ve(Se),ye=g(),L=v("p"),L.innerHTML=De,this.h()},l(s){Ge("svelte-1tq7k8",document.head).forEach(f),e=C(s),t=b(s,"H5",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-59fn2m"&&(t.textContent=o),i=C(s),a=b(s,"DIV",{class:!0,"data-svelte-h":!0}),$(a)!=="svelte-44tkgt"&&(a.innerHTML=p),c=C(s),r=b(s,"H5",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-belckq"&&(r.textContent=l),u=C(s),w=b(s,"DIV",{class:!0,"data-svelte-h":!0}),$(w)!=="svelte-180pb5l"&&(w.innerHTML=E),T=C(s),y=b(s,"H5",{class:!0,"data-svelte-h":!0}),$(y)!=="svelte-a9xi76"&&(y.textContent=_),I=C(s),G(D.$$.fragment,s),se=C(s),G(A.$$.fragment,s),oe=C(s),G(M.$$.fragment,s),ie=C(s),P=b(s,"H5",{class:!0,"data-svelte-h":!0}),$(P)!=="svelte-lt73ae"&&(P.textContent=xe),re=C(s),G(j.$$.fragment,s),le=C(s),N=b(s,"H5",{class:!0,"data-svelte-h":!0}),$(N)!=="svelte-rvnewg"&&(N.textContent=we),ce=C(s),R=b(s,"P",{class:!0,"data-svelte-h":!0}),$(R)!=="svelte-1lgglve"&&(R.innerHTML=ke),fe=C(s),V=b(s,"H5",{class:!0,"data-svelte-h":!0}),$(V)!=="svelte-4eqdct"&&(V.textContent=Be),ue=C(s),G(H.$$.fragment,s),pe=C(s),O=b(s,"H5",{class:!0,"data-svelte-h":!0}),$(O)!=="svelte-1lzk8dd"&&(O.textContent=Te),de=C(s),F=b(s,"DIV",{class:!0});var he=S(F);q=b(he,"P",{class:!0});var $e=S(q);ge=be($e,"Version: "),Ce=be($e,Se),$e.forEach(f),ye=C(he),L=b(he,"P",{class:!0,"data-svelte-h":!0}),$(L)!=="svelte-v401us"&&(L.innerHTML=De),he.forEach(f),this.h()},h(){document.title="Other - PourOverPotato app",h(t,"class","page-headline svelte-p097pa"),h(a,"class","about-section svelte-p097pa"),h(r,"class","svelte-p097pa"),h(w,"class","about-section svelte-p097pa"),h(y,"class","svelte-p097pa"),h(P,"class","svelte-p097pa"),h(N,"class","svelte-p097pa"),h(R,"class","svelte-p097pa"),h(V,"class","svelte-p097pa"),h(O,"class","svelte-p097pa"),h(q,"class","svelte-p097pa"),h(L,"class","svelte-p097pa"),h(F,"class","about-section svelte-p097pa")},m(s,m){d(s,e,m),d(s,t,m),d(s,i,m),d(s,a,m),d(s,c,m),d(s,r,m),d(s,u,m),d(s,w,m),d(s,T,m),d(s,y,m),d(s,I,m),z(D,s,m),d(s,se,m),z(A,s,m),d(s,oe,m),z(M,s,m),d(s,ie,m),d(s,P,m),d(s,re,m),z(j,s,m),d(s,le,m),d(s,N,m),d(s,ce,m),d(s,R,m),d(s,fe,m),d(s,V,m),d(s,ue,m),z(H,s,m),d(s,pe,m),d(s,O,m),d(s,de,m),d(s,F,m),x(F,q),x(q,ge),x(q,Ce),x(F,ye),x(F,L),me=!0},p:k,i(s){me||(J(D.$$.fragment,s),J(A.$$.fragment,s),J(M.$$.fragment,s),J(j.$$.fragment,s),J(H.$$.fragment,s),me=!0)},o(s){W(D.$$.fragment,s),W(A.$$.fragment,s),W(M.$$.fragment,s),W(j.$$.fragment,s),W(H.$$.fragment,s),me=!1},d(s){s&&(f(e),f(t),f(i),f(a),f(c),f(r),f(u),f(w),f(T),f(y),f(I),f(se),f(oe),f(ie),f(P),f(re),f(le),f(N),f(ce),f(R),f(fe),f(V),f(ue),f(pe),f(O),f(de),f(F)),Y(D,s),Y(A,s),Y(M,s),Y(j,s),Y(H,s)}}}class Mt extends X{constructor(e){super(),Z(this,e,null,St,Q,{})}}export{Mt as component};
