import{s as ve,b as K,a as q,f as me,r as Be,t as De,n as T}from"../chunks/scheduler.Cw1-ZcKD.js";import{S as we,i as Se,v as H,k as F,m as E,n as I,q as B,o as D,r as R,e as P,s as V,t as ee,c as O,a as G,f as z,b as te,d as v,z as C,C as _e,g as M,h as N,D as he,A as Q,B as Me,j as de,w as J,l as ye,p as ce,u as pe,y as se}from"../chunks/index.DHsbL8_X.js";import{c as Ne,d as Te,s as Fe,e as ge,u as Ee,o as Ie,h as Re,f as Pe}from"../chunks/manageCoffeeBeans.E__Z0lQp.js";import{g as x}from"../chunks/entry.D9J3zD_q.js";import{d as Oe,P as Ve}from"../chunks/PageHeadline._rhYHzjV.js";import{r as W}from"../chunks/routes.BpU10NWl.js";import{e as fe,p as ze,a as ue,s as be,h as Ae}from"../chunks/toastProvider.CA3wvqVI.js";import{S as Le,R as Ke}from"../chunks/SortRecipesSelect.C35uIoov.js";import{A as je,N as Ue}from"../chunks/NoItemsYetP.D6l6NNs8.js";import{L as Ce}from"../chunks/Loading.BjzKhRf5.js";import{L as qe,T as He}from"../chunks/Textarea.DN1j_bVF.js";import{M as We}from"../chunks/Modal.pZgItJ2F.js";import{F as Ye,D as Ge,a as Je}from"../chunks/FlexRow.kYR_1CSo.js";import{D as Qe}from"../chunks/DeleteConfirmationModal.C0krRx71.js";function Xe({params:a}){return{coffeeBeansName:a.name}}const Rt=Object.freeze(Object.defineProperty({__proto__:null,load:Xe},Symbol.toStringTag,{value:"Module"}));function Ze(a){let e;return{c(){e=ee("Coffee beans name:")},l(n){e=te(n,"Coffee beans name:")},m(n,t){M(n,e,t)},d(n){n&&v(e)}}}function xe(a){let e,n,t,o,r,l,i,f,c,p,$,u,s,_,d,k,A,g,m,w,y,U,Y;t=new qe({props:{for_:"name",valid:!a[3],$$slots:{default:[Ze]},$$scope:{ctx:a}}});function re(b){a[23](b)}function le(b){a[24](b)}function ie(b){a[25](b)}let X={id:"description",initialValue:a[0].description,label:"Description:",name:"description",placeholder:tt};return a[4]!==void 0&&(X.resizeTextarea=a[4]),a[10]!==void 0&&(X.this_=a[10]),a[2]!==void 0&&(X.value=a[2]),s=new He({props:X}),K.push(()=>H(s,"resizeTextarea",re)),K.push(()=>H(s,"this_",le)),K.push(()=>H(s,"value",ie)),s.$on("keydown",a[14]),{c(){e=P("form"),n=P("div"),F(t.$$.fragment),o=V(),r=P("input"),f=V(),c=P("p"),p=ee(a[11]),$=V(),u=P("div"),F(s.$$.fragment),A=V(),g=P("button"),m=ee("Save changes"),this.h()},l(b){e=O(b,"FORM",{class:!0});var S=G(e);n=O(S,"DIV",{class:!0});var L=G(n);E(t.$$.fragment,L),o=z(L),r=O(L,"INPUT",{id:!0,autocomplete:!0,class:!0,name:!0,placeholder:!0,type:!0}),f=z(L),c=O(L,"P",{class:!0});var j=G(c);p=te(j,a[11]),j.forEach(v),L.forEach(v),$=z(S),u=O(S,"DIV",{class:!0});var ne=G(u);E(s.$$.fragment,ne),ne.forEach(v),A=z(S),g=O(S,"BUTTON",{class:!0,type:!0});var ae=G(g);m=te(ae,"Save changes"),ae.forEach(v),S.forEach(v),this.h()},h(){C(r,"id","name"),C(r,"autocomplete","off"),C(r,"class",l=me(a[3]?"input-name-validation-failed":"input-name")+" svelte-ittp5u"),C(r,"name","name"),C(r,"placeholder",i=a[3]?"":"Example: Rwanda Mabanza"),C(r,"type","text"),_e(r,"unsaved-changes",a[0].name!==void 0&&a[0].name!==a[1]),C(c,"class","mt-2 text-sm text-red-600 dark:text-red-500"),C(n,"class","mb-5"),C(u,"class","my-div mb-5 svelte-ittp5u"),C(g,"class","button-submit svelte-ittp5u"),g.disabled=w=a[12]===!1||fe.hasValidName({name:a[1]})!==!0,C(g,"type","submit"),C(e,"class","mx-auto")},m(b,S){M(b,e,S),N(e,n),I(t,n,null),N(n,o),N(n,r),a[21](r),he(r,a[1]),N(n,f),N(n,c),N(c,p),N(e,$),N(e,u),I(s,u,null),N(e,A),N(e,g),N(g,m),a[26](g),a[27](e),y=!0,U||(Y=[Q(r,"input",a[22]),Q(r,"focusin",a[19]),Q(r,"input",a[17]),Q(r,"keydown",a[13]),Q(g,"keydown",a[18]),Q(e,"submit",Me(a[15]))],U=!0)},p(b,S){const L={};S[0]&8&&(L.valid=!b[3]),S[1]&1&&(L.$$scope={dirty:S,ctx:b}),t.$set(L),(!y||S[0]&8&&l!==(l=me(b[3]?"input-name-validation-failed":"input-name")+" svelte-ittp5u"))&&C(r,"class",l),(!y||S[0]&8&&i!==(i=b[3]?"":"Example: Rwanda Mabanza"))&&C(r,"placeholder",i),S[0]&2&&r.value!==b[1]&&he(r,b[1]),(!y||S[0]&11)&&_e(r,"unsaved-changes",b[0].name!==void 0&&b[0].name!==b[1]),(!y||S[0]&2048)&&de(p,b[11]);const j={};S[0]&1&&(j.initialValue=b[0].description),!_&&S[0]&16&&(_=!0,j.resizeTextarea=b[4],q(()=>_=!1)),!d&&S[0]&1024&&(d=!0,j.this_=b[10],q(()=>d=!1)),!k&&S[0]&4&&(k=!0,j.value=b[2],q(()=>k=!1)),s.$set(j),(!y||S[0]&4098&&w!==(w=b[12]===!1||fe.hasValidName({name:b[1]})!==!0))&&(g.disabled=w)},i(b){y||(B(t.$$.fragment,b),B(s.$$.fragment,b),y=!0)},o(b){D(t.$$.fragment,b),D(s.$$.fragment,b),y=!1},d(b){b&&v(e),R(t),a[21](null),R(s),a[26](null),a[27](null),U=!1,Be(Y)}}}function et(a){let e,n,t,o;function r(f){a[29](f)}function l(f){a[30](f)}let i={onFocusReverse:a[28],onStateChange:a[16],title:"Edit coffee beans",$$slots:{default:[xe]},$$scope:{ctx:a}};return a[5]!==void 0&&(i.setFocus=a[5]),a[6]!==void 0&&(i.setState=a[6]),e=new We({props:i}),K.push(()=>H(e,"setFocus",r)),K.push(()=>H(e,"setState",l)),{c(){F(e.$$.fragment)},l(f){E(e.$$.fragment,f)},m(f,c){I(e,f,c),o=!0},p(f,c){const p={};c[0]&512&&(p.onFocusReverse=f[28]),c[0]&8095|c[1]&1&&(p.$$scope={dirty:c,ctx:f}),!n&&c[0]&32&&(n=!0,p.setFocus=f[5],q(()=>n=!1)),!t&&c[0]&64&&(t=!0,p.setState=f[6],q(()=>t=!1)),e.$set(p)},i(f){o||(B(e.$$.fragment,f),o=!0)},o(f){D(e.$$.fragment,f),o=!1},d(f){R(e,f)}}}const tt="Example: Washed process. Notes: plum, cherry.";function nt(a,e,n){const t=h=>{i(h)};let{item:o}=e,r,l,i,f,c,p,$,u=o.name??"",s=o.description??"",_="",d=!1,k=!1;function A(h){h.key==="Enter"&&(h.preventDefault(),$.focus())}function g(h){h.key==="Enter"&&(h.metaKey||h.ctrlKey)&&(h.preventDefault(),f.requestSubmit())}async function m(){const h=new fe({id:o.id,name:u,description:s}),Z=ze.create(h);if(Z==="ValidationFailed_NameMustBeAtLeast3CharsLong"){n(3,d=!0),n(11,_="Name must be at least 3 characters long.");return}const oe=await Ne(Z);if(oe==="Failure_NameAlreadyExist"){n(3,d=!0),n(11,_="Coffee beans with this name exist already.");return}if(oe==="CoffeeBeansNotFound"){n(3,d=!1),ue("CoffeeBeans not found in the database. Operation aborted.");return}ue("Coffee beans modified."),n(0,o=oe),i("closed"),x(W.home).then(()=>x(W.coffeeBeansItem(oe.name)))}function w(h){h==="open"&&(n(1,u=o.name??""),n(2,s=o.description??""),n(11,_=""),De().then(()=>{r(),c.focus()}))}function y(){d&&(n(3,d=!1),n(11,_=""))}function U(h){h.key==="Tab"&&h.shiftKey===!1&&(h.preventDefault(),l())}function Y(h){const Z=h.currentTarget.value.length;c.setSelectionRange(Z,Z)}function re(h){K[h?"unshift":"push"](()=>{c=h,n(8,c)})}function le(){u=this.value,n(1,u)}function ie(h){r=h,n(4,r)}function X(h){$=h,n(10,$)}function b(h){s=h,n(2,s)}function S(h){K[h?"unshift":"push"](()=>{p=h,n(9,p)})}function L(h){K[h?"unshift":"push"](()=>{f=h,n(7,f)})}const j=()=>p.focus();function ne(h){l=h,n(5,l)}function ae(h){i=h,n(6,i)}return a.$$set=h=>{"item"in h&&n(0,o=h.item)},a.$$.update=()=>{a.$$.dirty[0]&8&&d===!1&&n(11,_=""),a.$$.dirty[0]&7&&(o&&u===o.name&&s===o.description?n(12,k=!1):n(12,k=!0))},[o,u,s,d,r,l,i,f,c,p,$,_,k,A,g,m,w,y,U,Y,t,re,le,ie,X,b,S,L,j,ne,ae]}class at extends we{constructor(e){super(),Se(this,e,nt,et,ve,{setModalState:20,item:0},null,[-1,-1])}get setModalState(){return this.$$.ctx[20]}}function $e(a,e,n){const t=a.slice();return t[15]=e[n],t}function ot(a){return document.title=a[5].name+" - PourOverPotato app",{c:T,l:T,m:T,d:T}}function st(a){return{c(){this.h()},l(e){this.h()},h(){document.title="404 Not Found - PourOverPotato app"},m:T,d:T}}function rt(a){return{c(){this.h()},l(e){this.h()},h(){document.title="loading... - PourOverPotato app"},m:T,d:T}}function lt(a){let e,n,t,o=a[5].description+"",r,l,i,f,c,p,$;e=new Ye({props:{$$slots:{default:[mt]},$$scope:{ctx:a}}});const u=[gt,ht,_t],s=[];function _(d,k){return d[0]===void 0?0:d[0].length===0?1:2}return i=_(a),f=s[i]=u[i](a),p=new je({props:{href:W.addRecipe(a[5].name)}}),{c(){F(e.$$.fragment),n=V(),t=P("p"),r=ee(o),l=V(),f.c(),c=V(),F(p.$$.fragment),this.h()},l(d){E(e.$$.fragment,d),n=z(d),t=O(d,"P",{class:!0});var k=G(t);r=te(k,o),k.forEach(v),l=z(d),f.l(d),c=z(d),E(p.$$.fragment,d),this.h()},h(){C(t,"class","coffee-beans-description svelte-kpt2oo")},m(d,k){I(e,d,k),M(d,n,k),M(d,t,k),N(t,r),M(d,l,k),s[i].m(d,k),M(d,c,k),I(p,d,k),$=!0},p(d,k){const A={};k&262204&&(A.$$scope={dirty:k,ctx:d}),e.$set(A),(!$||k&32)&&o!==(o=d[5].description+"")&&de(r,o);let g=i;i=_(d),i===g?s[i].p(d,k):(pe(),D(s[g],1,1,()=>{s[g]=null}),ce(),f=s[i],f?f.p(d,k):(f=s[i]=u[i](d),f.c()),B(f,1),f.m(c.parentNode,c));const m={};k&32&&(m.href=W.addRecipe(d[5].name)),p.$set(m)},i(d){$||(B(e.$$.fragment,d),B(f),B(p.$$.fragment,d),$=!0)},o(d){D(e.$$.fragment,d),D(f),D(p.$$.fragment,d),$=!1},d(d){d&&(v(n),v(t),v(l),v(c)),R(e,d),s[i].d(d),R(p,d)}}}function it(a){let e,n="<h1>404</h1> <p>Coffee beans not found.</p>";return{c(){e=P("div"),e.innerHTML=n,this.h()},l(t){e=O(t,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-akmamj"&&(e.innerHTML=n),this.h()},h(){C(e,"class","loading-position svelte-kpt2oo")},m(t,o){M(t,e,o)},p:T,i:T,o:T,d(t){t&&v(e)}}}function ft(a){let e,n,t;return n=new Ce({}),{c(){e=P("div"),F(n.$$.fragment),this.h()},l(o){e=O(o,"DIV",{class:!0});var r=G(e);E(n.$$.fragment,r),r.forEach(v),this.h()},h(){C(e,"class","loading-position svelte-kpt2oo")},m(o,r){M(o,e,r),I(n,e,null),t=!0},p:T,i(o){t||(B(n.$$.fragment,o),t=!0)},o(o){D(n.$$.fragment,o),t=!1},d(o){o&&v(e),R(n)}}}function ut(a){let e=a[5].name+"",n;return{c(){n=ee(e)},l(t){n=te(t,e)},m(t,o){M(t,n,o)},p(t,o){o&32&&e!==(e=t[5].name+"")&&de(n,e)},d(t){t&&v(n)}}}function dt(a){let e,n;return e=new Je({props:{slot:"button",buttonText:"Delete"}}),e.$on("click",a[11]),{c(){F(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,o){I(e,t,o),n=!0},p:T,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){R(e,t)}}}function ct(a){let e,n="Please confirm you want to delete these coffee beans.",t,o,r="The dependent recipes will be deleted too.";return{c(){e=P("p"),e.textContent=n,t=V(),o=P("p"),o.textContent=r},l(l){e=O(l,"P",{"data-svelte-h":!0}),se(e)!=="svelte-jtslft"&&(e.textContent=n),t=z(l),o=O(l,"P",{"data-svelte-h":!0}),se(o)!=="svelte-puw9d7"&&(o.textContent=r)},m(l,i){M(l,e,i),M(l,t,i),M(l,o,i)},p:T,d(l){l&&(v(e),v(t),v(o))}}}function pt(a){let e,n,t;function o(l){a[10](l)}let r={slot:"modal",onDeleteClick:a[6],$$slots:{default:[ct]},$$scope:{ctx:a}};return a[2]!==void 0&&(r.setModalState=a[2]),e=new Qe({props:r}),K.push(()=>H(e,"setModalState",o)),{c(){F(e.$$.fragment)},l(l){E(e.$$.fragment,l)},m(l,i){I(e,l,i),t=!0},p(l,i){const f={};i&262144&&(f.$$scope={dirty:i,ctx:l}),!n&&i&4&&(n=!0,f.setModalState=l[2],q(()=>n=!1)),e.$set(f)},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){R(e,l)}}}function mt(a){let e,n,t,o,r="Edit",l,i,f,c,p,$,u,s,_;e=new Ve({props:{$$slots:{default:[ut]},$$scope:{ctx:a}}});function d(m){a[9](m)}let k={item:a[5]};a[4]!==void 0&&(k.setModalState=a[4]),i=new at({props:k}),K.push(()=>H(i,"setModalState",d));function A(m){a[12](m)}let g={$$slots:{modal:[pt],button:[dt]},$$scope:{ctx:a}};return a[3]!==void 0&&(g.setDropdownState=a[3]),p=new Ge({props:g}),K.push(()=>H(p,"setDropdownState",A)),{c(){F(e.$$.fragment),n=V(),t=P("div"),o=P("button"),o.textContent=r,l=V(),F(i.$$.fragment),c=V(),F(p.$$.fragment),this.h()},l(m){E(e.$$.fragment,m),n=z(m),t=O(m,"DIV",{class:!0});var w=G(t);o=O(w,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),se(o)!=="svelte-gleq7e"&&(o.textContent=r),l=z(w),E(i.$$.fragment,w),c=z(w),E(p.$$.fragment,w),w.forEach(v),this.h()},h(){C(o,"class","edit-button svelte-kpt2oo"),C(o,"type","button"),C(t,"class","menu-container svelte-kpt2oo")},m(m,w){I(e,m,w),M(m,n,w),M(m,t,w),N(t,o),N(t,l),I(i,t,null),N(t,c),I(p,t,null),u=!0,s||(_=Q(o,"click",a[8]),s=!0)},p(m,w){const y={};w&262176&&(y.$$scope={dirty:w,ctx:m}),e.$set(y);const U={};w&32&&(U.item=m[5]),!f&&w&16&&(f=!0,U.setModalState=m[4],q(()=>f=!1)),i.$set(U);const Y={};w&262156&&(Y.$$scope={dirty:w,ctx:m}),!$&&w&8&&($=!0,Y.setDropdownState=m[3],q(()=>$=!1)),p.$set(Y)},i(m){u||(B(e.$$.fragment,m),B(i.$$.fragment,m),B(p.$$.fragment,m),u=!0)},o(m){D(e.$$.fragment,m),D(i.$$.fragment,m),D(p.$$.fragment,m),u=!1},d(m){m&&(v(n),v(t)),R(e,m),R(i),R(p),s=!1,_()}}}function _t(a){let e,n,t,o=[],r=new Map,l,i;function f(u){a[13](u)}let c={};a[1]!==void 0&&(c.sortOrderValue=a[1]),e=new Le({props:c}),K.push(()=>H(e,"sortOrderValue",f));let p=ge(a[0]);const $=u=>u[15].id;for(let u=0;u<p.length;u+=1){let s=$e(a,p,u),_=$(s);r.set(_,o[u]=ke(_,s))}return{c(){F(e.$$.fragment),t=V();for(let u=0;u<o.length;u+=1)o[u].c();l=J()},l(u){E(e.$$.fragment,u),t=z(u);for(let s=0;s<o.length;s+=1)o[s].l(u);l=J()},m(u,s){I(e,u,s),M(u,t,s);for(let _=0;_<o.length;_+=1)o[_]&&o[_].m(u,s);M(u,l,s),i=!0},p(u,s){const _={};!n&&s&2&&(n=!0,_.sortOrderValue=u[1],q(()=>n=!1)),e.$set(_),s&33&&(p=ge(u[0]),pe(),o=Ee(o,s,$,1,u,p,r,l.parentNode,Ie,ke,l,$e),ce())},i(u){if(!i){B(e.$$.fragment,u);for(let s=0;s<p.length;s+=1)B(o[s]);i=!0}},o(u){D(e.$$.fragment,u);for(let s=0;s<o.length;s+=1)D(o[s]);i=!1},d(u){u&&(v(t),v(l)),R(e,u);for(let s=0;s<o.length;s+=1)o[s].d(u)}}}function ht(a){let e,n;return e=new Ue({}),{c(){F(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,o){I(e,t,o),n=!0},p:T,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){R(e,t)}}}function gt(a){let e,n;return e=new Ce({}),{c(){F(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,o){I(e,t,o),n=!0},p:T,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){R(e,t)}}}function ke(a,e){let n,t,o;return t=new Ke({props:{coffeeBeansName:e[5].name,href:W.recipeItem(e[15].id),recipe:e[15]}}),{key:a,first:null,c(){n=J(),F(t.$$.fragment),this.h()},l(r){n=J(),E(t.$$.fragment,r),this.h()},h(){this.first=n},m(r,l){M(r,n,l),I(t,r,l),o=!0},p(r,l){e=r;const i={};l&32&&(i.coffeeBeansName=e[5].name),l&1&&(i.href=W.recipeItem(e[15].id)),l&1&&(i.recipe=e[15]),t.$set(i)},i(r){o||(B(t.$$.fragment,r),o=!0)},o(r){D(t.$$.fragment,r),o=!1},d(r){r&&v(n),R(t,r)}}}function bt(a){let e,n,t,o,r,l;function i(s,_){return s[5]===void 0?rt:s[5]==="CoffeeBeansNotFound"?st:ot}let f=i(a),c=f(a);const p=[ft,it,lt],$=[];function u(s,_){return s[5]===void 0?0:s[5]==="CoffeeBeansNotFound"?1:2}return t=u(a),o=$[t]=p[t](a),{c(){c.c(),e=J(),n=V(),o.c(),r=J()},l(s){const _=ye("svelte-1xzg8rg",document.head);c.l(_),e=J(),_.forEach(v),n=z(s),o.l(s),r=J()},m(s,_){c.m(document.head,null),N(document.head,e),M(s,n,_),$[t].m(s,_),M(s,r,_),l=!0},p(s,[_]){f!==(f=i(s))&&(c.d(1),c=f(s),c&&(c.c(),c.m(e.parentNode,e)));let d=t;t=u(s),t===d?$[t].p(s,_):(pe(),D($[d],1,1,()=>{$[d]=null}),ce(),o=$[t],o?o.p(s,_):(o=$[t]=p[t](s),o.c()),B(o,1),o.m(r.parentNode,r))},i(s){l||(B(o),l=!0)},o(s){D(o),l=!1},d(s){s&&(v(n),v(r)),c.d(s),v(e),$[t].d(s)}}}function $t(a,e,n){let{data:t}=e,o,r,l,i,f,c;async function p(){if(i===void 0||i==="CoffeeBeansNotFound")return;const g=i,m=await Fe(g.id);if(m==="CoffeeBeansNotFound"){ue("CoffeeBeans not found in the database. Operation aborted.");return}const w=m.recipesCount===1?"recipe":"recipes",y=m.recipesCount>0?` and ${m.recipesCount} ${w}`:"";Ae(`Coffee beans "${g.name}"`+y+" deleted.",async()=>{await Pe(g.id),x(W.coffeeBeansItem(g.name)).then(()=>x(W.home))},async()=>{await Re(g.id)}),x(W.home)}async function $(){const g=await Te(t.coffeeBeansName);if(g===void 0){n(5,i="CoffeeBeansNotFound");return}n(5,i=g);const m=await Oe(i.id);n(0,f=m.sort(be))}const u=()=>l("open");function s(g){l=g,n(4,l)}function _(g){o=g,n(2,o)}const d=()=>{o("open"),r("closed")};function k(g){r=g,n(3,r)}function A(g){c=g,n(1,c)}return a.$$set=g=>{"data"in g&&n(7,t=g.data)},a.$$.update=()=>{a.$$.dirty&3&&f&&n(0,f=f.sort((c==null?void 0:c.sortOrderFunc)??be)),a.$$.dirty&128&&window.indexedDB&&$()},[f,c,o,r,l,i,p,t,u,s,_,d,k,A]}class Pt extends we{constructor(e){super(),Se(this,e,$t,bt,ve,{data:7})}}export{Pt as component,Rt as universal};
