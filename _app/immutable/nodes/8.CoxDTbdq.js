import{s as _e,b as V,a as E,o as Oe,n as te}from"../chunks/scheduler.Cw1-ZcKD.js";import{S as he,i as $e,v as F,e as L,k as C,s as I,t as be,c as J,a as ie,m as D,f as R,b as ve,d as w,z as j,g as B,n as T,h as A,A as We,F as Xe,q as b,o as v,r as k,D as Ye,w as se,l as Ze,p as qe,u as ye,y as Ve}from"../chunks/index.D7LFJCWc.js";import{g as G,b as xe}from"../chunks/entry.CvaJmZne.js";import{e as et,s as tt,h as nt,u as at,P as it,d as st}from"../chunks/PageHeadline.kzRusPpm.js";import{x as ne,a as rt,n as ot}from"../chunks/core.D-38Eqyu.js";import{L as lt}from"../chunks/Loading.B4oECrVu.js";import{D as ft,a as ut,F as pt}from"../chunks/FlexRow.DE3jnZkC.js";import{g as mt,j as ct}from"../chunks/manageCoffeeBeans.l_UoDZFL.js";import{n as ae}from"../chunks/naming.DmthAWfq.js";import{r as z}from"../chunks/routes.DDLSSYwL.js";import{C as dt,F as gt,p as de,N as Ee,a as _t,T as ht,R as $t,D as bt,b as vt}from"../chunks/TextInput.DqXDoqNs.js";import{f as re,p as Fe}from"../chunks/dateHelpers.c45YBD0l.js";import{T as ge}from"../chunks/Textarea.CWUpZFM_.js";import{D as wt}from"../chunks/DeleteConfirmationModal.8wOzitwl.js";function Ct({params:i}){const e=Number.parseFloat(i.id);if(Number.isInteger(e)===!1)throw new Error("Non-integer route params are not allowed for this page. The matcher should have filtered outnon-integer values. Something is wrong with the code.");return{recipeId:e}}const an=Object.freeze(Object.defineProperty({__proto__:null,load:Ct},Symbol.toStringTag,{value:"Module"}));function Dt(i){let e,a,n,o,s,t,r,f,h,c;function d(u){i[16](u)}let S={initialValue:i[1].roastDate instanceof Date&&isFinite(i[1].roastDate.valueOf())?i[1].roastDate:new Date(0)};i[3]!==void 0&&(S.dateValue=i[3]),e=new $t({props:S}),V.push(()=>F(e,"dateValue",d)),o=new bt({props:{daysSinceRoast:i[13],onClear:i[17]}});function p(u){i[18](u)}let $={initialValue:i[1].bagNumber??"",labelText:"Bag number:",nameAttr:kt};return i[4]!==void 0&&($.value=i[4]),f=new vt({props:$}),V.push(()=>F(f,"value",p)),{c(){C(e.$$.fragment),n=I(),C(o.$$.fragment),s=I(),t=L("div"),r=I(),C(f.$$.fragment),this.h()},l(u){D(e.$$.fragment,u),n=R(u),D(o.$$.fragment,u),s=R(u),t=J(u,"DIV",{style:!0}),ie(t).forEach(w),r=R(u),D(f.$$.fragment,u),this.h()},h(){Ye(t,"flex-grow","1")},m(u,g){T(e,u,g),B(u,n,g),T(o,u,g),B(u,s,g),B(u,t,g),B(u,r,g),T(f,u,g),c=!0},p(u,g){const O={};g&2&&(O.initialValue=u[1].roastDate instanceof Date&&isFinite(u[1].roastDate.valueOf())?u[1].roastDate:new Date(0)),!a&&g&8&&(a=!0,O.dateValue=u[3],E(()=>a=!1)),e.$set(O);const W={};g&8192&&(W.daysSinceRoast=u[13]),g&8&&(W.onClear=u[17]),o.$set(W);const U={};g&2&&(U.initialValue=u[1].bagNumber??""),!h&&g&16&&(h=!0,U.value=u[4],E(()=>h=!1)),f.$set(U)},i(u){c||(b(e.$$.fragment,u),b(o.$$.fragment,u),b(f.$$.fragment,u),c=!0)},o(u){v(e.$$.fragment,u),v(o.$$.fragment,u),v(f.$$.fragment,u),c=!1},d(u){u&&(w(n),w(s),w(t),w(r)),k(e,u),k(o,u),k(f,u)}}}function Tt(i){let e,a,n,o,s,t,r,f,h,c,d,S,p,$,u,g,O,W,U,K,Q,P,X,Y,M,Z,x,N,_,H,q,ee,we;function Ge(l){i[15](l)}let Ce={allCoffeeBeans:i[12],initialCoffeeBeansId:i[1].coffeeBeansId,showAddButton:!1};i[2]!==void 0&&(Ce.selectedCoffeeBeansId=i[2]),a=new dt({props:Ce}),V.push(()=>F(a,"selectedCoffeeBeansId",Ge)),s=new gt({props:{$$slots:{default:[Dt]},$$scope:{ctx:i}}});function ze(l){i[19](l)}let De={id:Ne,initialValue:i[1].recipeTarget,label:ae.recipe.recipeTarget+":",name:Ne,placeholder:de.recipeTarget};i[5]!==void 0&&(De.value=i[5]),r=new ge({props:De}),V.push(()=>F(r,"value",ze));function He(l){i[20](l)}let Te={id:Pe,initialValue:i[1].recipeResult,label:ae.recipe.recipeResult+":",name:Pe,placeholder:de.recipeResult};i[6]!==void 0&&(Te.value=i[6]),c=new ge({props:Te}),V.push(()=>F(c,"value",He));function je(l){i[21](l)}let ke={initialValue:i[1].outWeight,labelText:ae.recipe.outWeight+" (g):",min:0,nameAttr:It,step:5};i[8]!==void 0&&(ke.value=i[8]),p=new Ee({props:ke}),V.push(()=>F(p,"value",je));function Le(l){i[22](l)}let Ie={initialValue:i[1].rating,labelText:"Rating:",max:5,min:0,nameAttr:Rt,step:.5};i[9]!==void 0&&(Ie.value=i[9]),g=new Ee({props:Ie}),V.push(()=>F(g,"value",Le));function Je(l){i[23](l)}let Re={initialValue:i[1].favorite};i[10]!==void 0&&(Re.value=i[10]),U=new _t({props:Re}),V.push(()=>F(U,"value",Je));function Ke(l){i[24](l)}let Be={id:Me,initialValue:i[1].recipeThoughts,label:ae.recipe.recipeThoughts+":",name:Me,placeholder:de.recipeThoughts};i[7]!==void 0&&(Be.value=i[7]),P=new ge({props:Be}),V.push(()=>F(P,"value",Ke));function Qe(l){i[25](l)}let Se={initialValue:re(i[1].timestamp)};return i[11]!==void 0&&(Se.value=i[11]),M=new ht({props:Se}),V.push(()=>F(M,"value",Qe)),{c(){e=L("form"),C(a.$$.fragment),o=I(),C(s.$$.fragment),t=I(),C(r.$$.fragment),h=I(),C(c.$$.fragment),S=I(),C(p.$$.fragment),u=I(),C(g.$$.fragment),W=I(),C(U.$$.fragment),Q=I(),C(P.$$.fragment),Y=I(),C(M.$$.fragment),x=I(),N=L("button"),_=be("Save changes"),this.h()},l(l){e=J(l,"FORM",{id:!0,class:!0});var m=ie(e);D(a.$$.fragment,m),o=R(m),D(s.$$.fragment,m),t=R(m),D(r.$$.fragment,m),h=R(m),D(c.$$.fragment,m),S=R(m),D(p.$$.fragment,m),u=R(m),D(g.$$.fragment,m),W=R(m),D(U.$$.fragment,m),Q=R(m),D(P.$$.fragment,m),Y=R(m),D(M.$$.fragment,m),x=R(m),N=J(m,"BUTTON",{class:!0,form:!0,type:!0});var y=ie(N);_=ve(y,"Save changes"),y.forEach(w),m.forEach(w),this.h()},h(){j(N,"class","my-button svelte-1rzvkbq"),N.disabled=H=i[0]===!1,j(N,"form","edit-recipe"),j(N,"type","submit"),j(e,"id","edit-recipe"),j(e,"class","svelte-1rzvkbq")},m(l,m){B(l,e,m),T(a,e,null),A(e,o),T(s,e,null),A(e,t),T(r,e,null),A(e,h),T(c,e,null),A(e,S),T(p,e,null),A(e,u),T(g,e,null),A(e,W),T(U,e,null),A(e,Q),T(P,e,null),A(e,Y),T(M,e,null),A(e,x),A(e,N),A(N,_),q=!0,ee||(we=We(e,"submit",Xe(i[14])),ee=!0)},p(l,[m]){const y={};m&4096&&(y.allCoffeeBeans=l[12]),m&2&&(y.initialCoffeeBeansId=l[1].coffeeBeansId),!n&&m&4&&(n=!0,y.selectedCoffeeBeansId=l[2],E(()=>n=!1)),a.$set(y);const Ue={};m&67117082&&(Ue.$$scope={dirty:m,ctx:l}),s.$set(Ue);const oe={};m&2&&(oe.initialValue=l[1].recipeTarget),!f&&m&32&&(f=!0,oe.value=l[5],E(()=>f=!1)),r.$set(oe);const le={};m&2&&(le.initialValue=l[1].recipeResult),!d&&m&64&&(d=!0,le.value=l[6],E(()=>d=!1)),c.$set(le);const fe={};m&2&&(fe.initialValue=l[1].outWeight),!$&&m&256&&($=!0,fe.value=l[8],E(()=>$=!1)),p.$set(fe);const ue={};m&2&&(ue.initialValue=l[1].rating),!O&&m&512&&(O=!0,ue.value=l[9],E(()=>O=!1)),g.$set(ue);const pe={};m&2&&(pe.initialValue=l[1].favorite),!K&&m&1024&&(K=!0,pe.value=l[10],E(()=>K=!1)),U.$set(pe);const me={};m&2&&(me.initialValue=l[1].recipeThoughts),!X&&m&128&&(X=!0,me.value=l[7],E(()=>X=!1)),P.$set(me);const ce={};m&2&&(ce.initialValue=re(l[1].timestamp)),!Z&&m&2048&&(Z=!0,ce.value=l[11],E(()=>Z=!1)),M.$set(ce),(!q||m&1&&H!==(H=l[0]===!1))&&(N.disabled=H)},i(l){q||(b(a.$$.fragment,l),b(s.$$.fragment,l),b(r.$$.fragment,l),b(c.$$.fragment,l),b(p.$$.fragment,l),b(g.$$.fragment,l),b(U.$$.fragment,l),b(P.$$.fragment,l),b(M.$$.fragment,l),q=!0)},o(l){v(a.$$.fragment,l),v(s.$$.fragment,l),v(r.$$.fragment,l),v(c.$$.fragment,l),v(p.$$.fragment,l),v(g.$$.fragment,l),v(U.$$.fragment,l),v(P.$$.fragment,l),v(M.$$.fragment,l),q=!1},d(l){l&&w(e),k(a),k(s),k(r),k(c),k(p),k(g),k(U),k(P),k(M),ee=!1,we()}}}const kt="bag-number",Ne="recipe-target",Pe="recipe-result",Me="recipe-thoughts",It="out-weight",Rt="rating";function Bt(i,e,a){let{recipe:n}=e,o,s=n.coffeeBeansId,t=n.roastDate instanceof Date&&isFinite(n.roastDate.valueOf())?n.roastDate:new Date(0),r=n.bagNumber??"",f=n.recipeTarget,h=n.recipeResult,c=n.recipeThoughts,d=n.outWeight,S=n.rating,p=n.favorite,$=re(n.timestamp),u,{hasUnsavedChanges:g=!1}=e;Oe(()=>{mt().then(_=>{a(12,o=_)})});async function O(){a(4,r=r.trim()),a(5,f=f.trim()),a(6,h=h.trim()),a(7,c=c.trim());const _=Fe($);if(s===void 0)throw new Error("Please select the coffee beans.");if(n==null)throw new Error("Recipe was undefined or null somehow.");const H=new ne({id:n.id,coffeeBeansId:s,roastDate:t,bagNumber:r,recipeTarget:f,recipeResult:h,recipeThoughts:c,outWeight:d,rating:S,favorite:p,timestamp:_});await et(H),rt("Recipe modified.");const q=o==null?void 0:o.find(ee=>ee.id===s);if(a(0,g=!1),q===void 0){G(z.home);return}G(z.coffeeBeansItem(q.name))}function W(_){s=_,a(2,s)}function U(_){t=_,a(3,t)}const K=()=>a(3,t=new Date(0));function Q(_){r=_,a(4,r)}function P(_){f=_,a(5,f)}function X(_){h=_,a(6,h)}function Y(_){d=_,a(8,d)}function M(_){S=_,a(9,S)}function Z(_){p=_,a(10,p)}function x(_){c=_,a(7,c)}function N(_){$=_,a(11,$)}return i.$$set=_=>{"recipe"in _&&a(1,n=_.recipe),"hasUnsavedChanges"in _&&a(0,g=_.hasUnsavedChanges)},i.$$.update=()=>{i.$$.dirty&2056&&a(13,u=ne.calculateDaysSinceRoast(Fe($),t)),i.$$.dirty&4094&&(n&&s===n.coffeeBeansId&&t.getTime()===(n.roastDate?n.roastDate.getTime():0)&&r.trim()===(n.bagNumber??"")&&f.trim()===n.recipeTarget&&h.trim()===n.recipeResult&&c.trim()===n.recipeThoughts&&d===n.outWeight&&S===n.rating&&p===n.favorite&&$===re(n.timestamp)?a(0,g=!1):a(0,g=!0))},[g,n,s,t,r,f,h,c,d,S,p,$,o,u,O,W,U,K,Q,P,X,Y,M,Z,x,N]}class St extends he{constructor(e){super(),$e(this,e,Bt,Tt,_e,{recipe:1,hasUnsavedChanges:0})}}function Ut(i){let e,a;return e=new ut({props:{slot:"button",buttonText:"Delete"}}),e.$on("click",i[6]),{c(){C(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){T(e,n,o),a=!0},p:te,i(n){a||(b(e.$$.fragment,n),a=!0)},o(n){v(e.$$.fragment,n),a=!1},d(n){k(e,n)}}}function Vt(i){let e;return{c(){e=be("Please confirm you want to delete this recipe")},l(a){e=ve(a,"Please confirm you want to delete this recipe")},m(a,n){B(a,e,n)},d(a){a&&w(e)}}}function Et(i){let e,a,n;function o(t){i[5](t)}let s={slot:"modal",onDeleteClick:i[2],$$slots:{default:[Vt]},$$scope:{ctx:i}};return i[0]!==void 0&&(s.setModalState=i[0]),e=new wt({props:s}),V.push(()=>F(e,"setModalState",o)),{c(){C(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,r){T(e,t,r),n=!0},p(t,r){const f={};r&256&&(f.$$scope={dirty:r,ctx:t}),!a&&r&1&&(a=!0,f.setModalState=t[0],E(()=>a=!1)),e.$set(f)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Ft(i){let e,a,n,o;function s(r){i[7](r)}let t={$$slots:{modal:[Et],button:[Ut]},$$scope:{ctx:i}};return i[1]!==void 0&&(t.setDropdownState=i[1]),a=new ft({props:t}),V.push(()=>F(a,"setDropdownState",s)),{c(){e=L("div"),C(a.$$.fragment),this.h()},l(r){e=J(r,"DIV",{class:!0});var f=ie(e);D(a.$$.fragment,f),f.forEach(w),this.h()},h(){j(e,"class","menu-container svelte-bedw36")},m(r,f){B(r,e,f),T(a,e,null),o=!0},p(r,[f]){const h={};f&259&&(h.$$scope={dirty:f,ctx:r}),!n&&f&2&&(n=!0,h.setDropdownState=r[1],E(()=>n=!1)),a.$set(h)},i(r){o||(b(a.$$.fragment,r),o=!0)},o(r){v(a.$$.fragment,r),o=!1},d(r){r&&w(e),k(a)}}}function Nt(i,e,a){let{recipe:n}=e,{ignoreUnsavedChanges:o=!1}=e,s,t;async function r(){await tt(n.id);const d=await ct(n.coffeeBeansId);ot("Recipe deleted.",async()=>{await at(n.id),G(z.home).then(()=>d?G(z.coffeeBeansItem(d.name)):G(z.home))},async()=>{await nt(n.id)}),a(3,o=!0),d?G(z.coffeeBeansItem(d.name)):G(z.home)}function f(d){s=d,a(0,s)}const h=()=>{t("closed"),s("open")};function c(d){t=d,a(1,t)}return i.$$set=d=>{"recipe"in d&&a(4,n=d.recipe),"ignoreUnsavedChanges"in d&&a(3,o=d.ignoreUnsavedChanges)},[s,t,r,o,n,f,h,c]}class Pt extends he{constructor(e){super(),$e(this,e,Nt,Ft,_e,{recipe:4,ignoreUnsavedChanges:3})}}function Mt(i){let e;return{c(){e=be("Edit recipe")},l(a){e=ve(a,"Edit recipe")},m(a,n){B(a,e,n)},d(a){a&&w(e)}}}function Ae(i){let e,a,n;function o(t){i[5](t)}let s={recipe:i[0]};return i[2]!==void 0&&(s.ignoreUnsavedChanges=i[2]),e=new Pt({props:s}),V.push(()=>F(e,"ignoreUnsavedChanges",o)),{c(){C(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,r){T(e,t,r),n=!0},p(t,r){const f={};r&1&&(f.recipe=t[0]),!a&&r&4&&(a=!0,f.ignoreUnsavedChanges=t[2],E(()=>a=!1)),e.$set(f)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function At(i){let e,a,n,o;e=new it({props:{$$slots:{default:[Mt]},$$scope:{ctx:i}}});let s=i[0]instanceof ne&&Ae(i);return{c(){C(e.$$.fragment),a=I(),s&&s.c(),n=se()},l(t){D(e.$$.fragment,t),a=R(t),s&&s.l(t),n=se()},m(t,r){T(e,t,r),B(t,a,r),s&&s.m(t,r),B(t,n,r),o=!0},p(t,r){const f={};r&128&&(f.$$scope={dirty:r,ctx:t}),e.$set(f),t[0]instanceof ne?s?(s.p(t,r),r&1&&b(s,1)):(s=Ae(t),s.c(),b(s,1),s.m(n.parentNode,n)):s&&(ye(),v(s,1,1,()=>{s=null}),qe())},i(t){o||(b(e.$$.fragment,t),b(s),o=!0)},o(t){v(e.$$.fragment,t),v(s),o=!1},d(t){t&&(w(a),w(n)),k(e,t),s&&s.d(t)}}}function Ot(i){let e,a="404",n,o,s="Not Found";return{c(){e=L("p"),e.textContent=a,n=I(),o=L("p"),o.textContent=s},l(t){e=J(t,"P",{"data-svelte-h":!0}),Ve(e)!=="svelte-swq3p4"&&(e.textContent=a),n=R(t),o=J(t,"P",{"data-svelte-h":!0}),Ve(o)!=="svelte-14ywr5"&&(o.textContent=s)},m(t,r){B(t,e,r),B(t,n,r),B(t,o,r)},p:te,i:te,o:te,d(t){t&&(w(e),w(n),w(o))}}}function Wt(i){let e,a,n;function o(t){i[6](t)}let s={recipe:i[0]};return i[1]!==void 0&&(s.hasUnsavedChanges=i[1]),e=new St({props:s}),V.push(()=>F(e,"hasUnsavedChanges",o)),{c(){C(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,r){T(e,t,r),n=!0},p(t,r){const f={};r&1&&(f.recipe=t[0]),!a&&r&2&&(a=!0,f.hasUnsavedChanges=t[1],E(()=>a=!1)),e.$set(f)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function qt(i){let e,a;return e=new lt({}),{c(){C(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){T(e,n,o),a=!0},p:te,i(n){a||(b(e.$$.fragment,n),a=!0)},o(n){v(e.$$.fragment,n),a=!1},d(n){k(e,n)}}}function yt(i){let e,a,n,o,s,t,r,f,h;a=new pt({props:{$$slots:{default:[At]},$$scope:{ctx:i}}});const c=[qt,Wt,Ot],d=[];function S(p,$){return p[0]===null?0:p[0]instanceof ne?1:2}return o=S(i),s=d[o]=c[o](i),{c(){e=I(),C(a.$$.fragment),n=I(),s.c(),t=se(),this.h()},l(p){Ze("svelte-5o91nh",document.head).forEach(w),e=R(p),D(a.$$.fragment,p),n=R(p),s.l(p),t=se(),this.h()},h(){document.title="Edit recipe - PourOverPotato"},m(p,$){B(p,e,$),T(a,p,$),B(p,n,$),d[o].m(p,$),B(p,t,$),r=!0,f||(h=We(window,"beforeunload",i[3]),f=!0)},p(p,[$]){const u={};$&133&&(u.$$scope={dirty:$,ctx:p}),a.$set(u);let g=o;o=S(p),o===g?d[o].p(p,$):(ye(),v(d[g],1,1,()=>{d[g]=null}),qe(),s=d[o],s?s.p(p,$):(s=d[o]=c[o](p),s.c()),b(s,1),s.m(t.parentNode,t))},i(p){r||(b(a.$$.fragment,p),b(s),r=!0)},o(p){v(a.$$.fragment,p),v(s),r=!1},d(p){p&&(w(e),w(n),w(t)),k(a,p),d[o].d(p),f=!1,h()}}}function Gt(i,e,a){let{data:n}=e,o=null,s,t;Oe(()=>{st(n.recipeId).then(c=>{a(0,o=c)})}),xe(c=>{c.willUnload===!1&&s&&t===!1&&confirm("Do you want to navigate away and lose unsaved changes?")===!1&&c.cancel()});function r(c){if(s&&t===!1)return c.preventDefault(),c.returnValue="","Are you sure you want to navigate away?"}function f(c){t=c,a(2,t)}function h(c){s=c,a(1,s)}return i.$$set=c=>{"data"in c&&a(4,n=c.data)},[o,s,t,r,n,f,h]}class sn extends he{constructor(e){super(),$e(this,e,Gt,yt,_e,{data:4})}}export{sn as component,an as universal};
