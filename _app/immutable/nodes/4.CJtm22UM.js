import{s as be,b as L,a as q,f as de,r as Ce,t as Se,n as y}from"../chunks/scheduler.Cw1-ZcKD.js";import{S as $e,i as ve,v as H,k as N,m as F,n as E,q as B,o as D,r as I,e as R,s as O,t as ae,c as P,a as Q,f as V,b as oe,d as w,y as ee,z as S,C as ce,g as M,h as T,D as me,A as J,B as Be,j as ie,w as Y,l as De,p as fe,u as ue}from"../chunks/index.DHsbL8_X.js";import{c as Me,d as ye,s as Te,e as pe,u as Ne,o as Fe,h as Ee,f as Ie}from"../chunks/manageCoffeeBeans.CzXUSSc2.js";import{g as x}from"../chunks/entry.Dmx3Y1eU.js";import{d as Re,P as Pe}from"../chunks/PageHeadline.DK2gBKFE.js";import{r as U}from"../chunks/routes.Dv_Wm252.js";import{s as _e,A as Oe,N as Ve}from"../chunks/NoItemsYetP.DACx20en.js";import{S as ze,R as Ae}from"../chunks/SortRecipesSelect.Xbj6RG0n.js";import{L as ke}from"../chunks/Loading.BjzKhRf5.js";import{F as Le,D as Ke,a as je}from"../chunks/FlexRow.Ci6Z7vlA.js";import{D as qe}from"../chunks/DeleteConfirmationModal.DA7syV6L.js";import{e as He,l as Ue,a as le,i as We}from"../chunks/dateHelpers.DtGJLfnR.js";import{L as Ye,T as Ge}from"../chunks/Textarea.DSVAmZwN.js";import{M as Je}from"../chunks/Modal.BfvLJiFc.js";function Qe({params:a}){return{coffeeBeansName:a.name}}const It=Object.freeze(Object.defineProperty({__proto__:null,load:Qe},Symbol.toStringTag,{value:"Module"}));function Xe(a){let e;return{c(){e=ae("Coffee beans name:")},l(n){e=oe(n,"Coffee beans name:")},m(n,t){M(n,e,t)},d(n){n&&w(e)}}}function Ze(a){let e,n,t,o,r,l,i,f,c,m,$,u,s,_,d,k,z,g,p="Save changes",v,K,W;t=new Ye({props:{for_:"name",valid:!a[1],$$slots:{default:[Xe]},$$scope:{ctx:a}}});function G(b){a[22](b)}function se(b){a[23](b)}function re(b){a[24](b)}let X={id:"description",initialValue:a[0].description,label:"Description:",name:"description",placeholder:et};return a[2]!==void 0&&(X.resizeTextarea=a[2]),a[8]!==void 0&&(X.this_=a[8]),a[10]!==void 0&&(X.value=a[10]),s=new Ge({props:X}),L.push(()=>H(s,"resizeTextarea",G)),L.push(()=>H(s,"this_",se)),L.push(()=>H(s,"value",re)),s.$on("keydown",a[13]),{c(){e=R("form"),n=R("div"),N(t.$$.fragment),o=O(),r=R("input"),f=O(),c=R("p"),m=ae(a[11]),$=O(),u=R("div"),N(s.$$.fragment),z=O(),g=R("button"),g.textContent=p,this.h()},l(b){e=P(b,"FORM",{class:!0});var C=Q(e);n=P(C,"DIV",{class:!0});var A=Q(n);F(t.$$.fragment,A),o=V(A),r=P(A,"INPUT",{id:!0,autocomplete:!0,class:!0,name:!0,placeholder:!0,type:!0}),f=V(A),c=P(A,"P",{class:!0});var j=Q(c);m=oe(j,a[11]),j.forEach(w),A.forEach(w),$=V(C),u=P(C,"DIV",{class:!0});var te=Q(u);F(s.$$.fragment,te),te.forEach(w),z=V(C),g=P(C,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ee(g)!=="svelte-xe5dhg"&&(g.textContent=p),C.forEach(w),this.h()},h(){S(r,"id","name"),S(r,"autocomplete","off"),S(r,"class",l=de(a[1]?"input-name-validation-failed":"input-name")+" svelte-m1pnmk"),S(r,"name","name"),S(r,"placeholder",i=a[1]?"":"Example: Rwanda Mabanza"),S(r,"type","text"),ce(r,"unsaved-changes",a[0].name!==void 0&&a[0].name!==a[9]),S(c,"class","mt-2 text-sm text-red-600 dark:text-red-500"),S(n,"class","mb-5"),S(u,"class","my-div mb-5 svelte-m1pnmk"),S(g,"class","button-submit svelte-m1pnmk"),S(g,"type","submit"),S(e,"class","mx-auto")},m(b,C){M(b,e,C),T(e,n),E(t,n,null),T(n,o),T(n,r),a[20](r),me(r,a[9]),T(n,f),T(n,c),T(c,m),T(e,$),T(e,u),E(s,u,null),T(e,z),T(e,g),a[25](g),a[26](e),v=!0,K||(W=[J(r,"input",a[21]),J(r,"focusin",a[18]),J(r,"input",a[16]),J(r,"keydown",a[12]),J(g,"keydown",a[17]),J(e,"submit",Be(a[14]))],K=!0)},p(b,C){const A={};C&2&&(A.valid=!b[1]),C&1073741824&&(A.$$scope={dirty:C,ctx:b}),t.$set(A),(!v||C&2&&l!==(l=de(b[1]?"input-name-validation-failed":"input-name")+" svelte-m1pnmk"))&&S(r,"class",l),(!v||C&2&&i!==(i=b[1]?"":"Example: Rwanda Mabanza"))&&S(r,"placeholder",i),C&512&&r.value!==b[9]&&me(r,b[9]),(!v||C&515)&&ce(r,"unsaved-changes",b[0].name!==void 0&&b[0].name!==b[9]),(!v||C&2048)&&ie(m,b[11]);const j={};C&1&&(j.initialValue=b[0].description),!_&&C&4&&(_=!0,j.resizeTextarea=b[2],q(()=>_=!1)),!d&&C&256&&(d=!0,j.this_=b[8],q(()=>d=!1)),!k&&C&1024&&(k=!0,j.value=b[10],q(()=>k=!1)),s.$set(j)},i(b){v||(B(t.$$.fragment,b),B(s.$$.fragment,b),v=!0)},o(b){D(t.$$.fragment,b),D(s.$$.fragment,b),v=!1},d(b){b&&w(e),I(t),a[20](null),I(s),a[25](null),a[26](null),K=!1,Ce(W)}}}function xe(a){let e,n,t,o;function r(f){a[28](f)}function l(f){a[29](f)}let i={onFocusReverse:a[27],onStateChange:a[15],title:"Edit coffee beans",$$slots:{default:[Ze]},$$scope:{ctx:a}};return a[3]!==void 0&&(i.setFocus=a[3]),a[4]!==void 0&&(i.setState=a[4]),e=new Je({props:i}),L.push(()=>H(e,"setFocus",r)),L.push(()=>H(e,"setState",l)),{c(){N(e.$$.fragment)},l(f){F(e.$$.fragment,f)},m(f,c){E(e,f,c),o=!0},p(f,[c]){const m={};c&128&&(m.onFocusReverse=f[27]),c&1073745895&&(m.$$scope={dirty:c,ctx:f}),!n&&c&8&&(n=!0,m.setFocus=f[3],q(()=>n=!1)),!t&&c&16&&(t=!0,m.setState=f[4],q(()=>t=!1)),e.$set(m)},i(f){o||(B(e.$$.fragment,f),o=!0)},o(f){D(e.$$.fragment,f),o=!1},d(f){I(e,f)}}}const et="Example: Washed process. Notes: plum, cherry.";function tt(a,e,n){const t=h=>{i(h)};let{item:o}=e,r,l,i,f,c,m,$,u=o.name??"",s=o.description??"",_="",d=!1;function k(h){h.key==="Enter"&&(h.preventDefault(),$.focus())}function z(h){h.key==="Enter"&&(h.metaKey||h.ctrlKey)&&(h.preventDefault(),f.requestSubmit())}async function g(){const h=new He({id:o.id,name:u,description:s}),Z=Ue.create(h);if(Z==="ValidationFailed_NameMustBeAtLeast3CharsLong"){n(1,d=!0),n(11,_="Name must be at least 3 characters long.");return}const ne=await Me(Z);if(ne==="Failure_NameAlreadyExist"){n(1,d=!0),n(11,_="Coffee beans with this name exist already.");return}if(ne==="CoffeeBeansNotFound"){n(1,d=!1),le("CoffeeBeans not found in the database. Operation aborted.");return}le("Coffee beans modified."),n(0,o=ne),i("closed"),x(U.home).then(()=>x(U.coffeeBeansItem(ne.name)))}function p(h){h==="open"&&(n(9,u=o.name??""),n(10,s=o.description??""),n(11,_=""),Se().then(()=>{r(),c.focus()}))}function v(){d&&(n(1,d=!1),n(11,_=""))}function K(h){h.key==="Tab"&&h.shiftKey===!1&&(h.preventDefault(),l())}function W(h){const Z=h.currentTarget.value.length;c.setSelectionRange(Z,Z)}function G(h){L[h?"unshift":"push"](()=>{c=h,n(6,c)})}function se(){u=this.value,n(9,u)}function re(h){r=h,n(2,r)}function X(h){$=h,n(8,$)}function b(h){s=h,n(10,s)}function C(h){L[h?"unshift":"push"](()=>{m=h,n(7,m)})}function A(h){L[h?"unshift":"push"](()=>{f=h,n(5,f)})}const j=()=>m.focus();function te(h){l=h,n(3,l)}function we(h){i=h,n(4,i)}return a.$$set=h=>{"item"in h&&n(0,o=h.item)},a.$$.update=()=>{a.$$.dirty&2&&d===!1&&n(11,_="")},[o,d,r,l,i,f,c,m,$,u,s,_,k,z,g,p,v,K,W,t,G,se,re,X,b,C,A,j,te,we]}class nt extends $e{constructor(e){super(),ve(this,e,tt,xe,be,{setModalState:19,item:0})}get setModalState(){return this.$$.ctx[19]}}function he(a,e,n){const t=a.slice();return t[15]=e[n],t}function at(a){return document.title=a[5].name+" - PourOverPotato app",{c:y,l:y,m:y,d:y}}function ot(a){return{c(){this.h()},l(e){this.h()},h(){document.title="404 Not Found - PourOverPotato app"},m:y,d:y}}function st(a){return{c(){this.h()},l(e){this.h()},h(){document.title="loading... - PourOverPotato app"},m:y,d:y}}function rt(a){let e,n,t,o=a[5].description+"",r,l,i,f,c,m,$;e=new Le({props:{$$slots:{default:[mt]},$$scope:{ctx:a}}});const u=[ht,_t,pt],s=[];function _(d,k){return d[0]===void 0?0:d[0].length===0?1:2}return i=_(a),f=s[i]=u[i](a),m=new Oe({props:{href:U.addRecipe(a[5].name)}}),{c(){N(e.$$.fragment),n=O(),t=R("p"),r=ae(o),l=O(),f.c(),c=O(),N(m.$$.fragment),this.h()},l(d){F(e.$$.fragment,d),n=V(d),t=P(d,"P",{class:!0});var k=Q(t);r=oe(k,o),k.forEach(w),l=V(d),f.l(d),c=V(d),F(m.$$.fragment,d),this.h()},h(){S(t,"class","coffee-beans-description svelte-1vu3dn8")},m(d,k){E(e,d,k),M(d,n,k),M(d,t,k),T(t,r),M(d,l,k),s[i].m(d,k),M(d,c,k),E(m,d,k),$=!0},p(d,k){const z={};k&262204&&(z.$$scope={dirty:k,ctx:d}),e.$set(z),(!$||k&32)&&o!==(o=d[5].description+"")&&ie(r,o);let g=i;i=_(d),i===g?s[i].p(d,k):(ue(),D(s[g],1,1,()=>{s[g]=null}),fe(),f=s[i],f?f.p(d,k):(f=s[i]=u[i](d),f.c()),B(f,1),f.m(c.parentNode,c));const p={};k&32&&(p.href=U.addRecipe(d[5].name)),m.$set(p)},i(d){$||(B(e.$$.fragment,d),B(f),B(m.$$.fragment,d),$=!0)},o(d){D(e.$$.fragment,d),D(f),D(m.$$.fragment,d),$=!1},d(d){d&&(w(n),w(t),w(l),w(c)),I(e,d),s[i].d(d),I(m,d)}}}function lt(a){let e,n="<h1>404</h1> <p>Coffee beans not found.</p>";return{c(){e=R("div"),e.innerHTML=n,this.h()},l(t){e=P(t,"DIV",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-akmamj"&&(e.innerHTML=n),this.h()},h(){S(e,"class","loading-position svelte-1vu3dn8")},m(t,o){M(t,e,o)},p:y,i:y,o:y,d(t){t&&w(e)}}}function it(a){let e,n,t;return n=new ke({}),{c(){e=R("div"),N(n.$$.fragment),this.h()},l(o){e=P(o,"DIV",{class:!0});var r=Q(e);F(n.$$.fragment,r),r.forEach(w),this.h()},h(){S(e,"class","loading-position svelte-1vu3dn8")},m(o,r){M(o,e,r),E(n,e,null),t=!0},p:y,i(o){t||(B(n.$$.fragment,o),t=!0)},o(o){D(n.$$.fragment,o),t=!1},d(o){o&&w(e),I(n)}}}function ft(a){let e=a[5].name+"",n;return{c(){n=ae(e)},l(t){n=oe(t,e)},m(t,o){M(t,n,o)},p(t,o){o&32&&e!==(e=t[5].name+"")&&ie(n,e)},d(t){t&&w(n)}}}function ut(a){let e,n;return e=new je({props:{slot:"button",buttonText:"Delete"}}),e.$on("click",a[11]),{c(){N(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,o){E(e,t,o),n=!0},p:y,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){I(e,t)}}}function dt(a){let e,n="Please confirm you want to delete these coffee beans.",t,o,r="The dependent recipes will be deleted too.";return{c(){e=R("p"),e.textContent=n,t=O(),o=R("p"),o.textContent=r},l(l){e=P(l,"P",{"data-svelte-h":!0}),ee(e)!=="svelte-jtslft"&&(e.textContent=n),t=V(l),o=P(l,"P",{"data-svelte-h":!0}),ee(o)!=="svelte-puw9d7"&&(o.textContent=r)},m(l,i){M(l,e,i),M(l,t,i),M(l,o,i)},p:y,d(l){l&&(w(e),w(t),w(o))}}}function ct(a){let e,n,t;function o(l){a[10](l)}let r={slot:"modal",onDeleteClick:a[6],$$slots:{default:[dt]},$$scope:{ctx:a}};return a[2]!==void 0&&(r.setModalState=a[2]),e=new qe({props:r}),L.push(()=>H(e,"setModalState",o)),{c(){N(e.$$.fragment)},l(l){F(e.$$.fragment,l)},m(l,i){E(e,l,i),t=!0},p(l,i){const f={};i&262144&&(f.$$scope={dirty:i,ctx:l}),!n&&i&4&&(n=!0,f.setModalState=l[2],q(()=>n=!1)),e.$set(f)},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){I(e,l)}}}function mt(a){let e,n,t,o,r="Edit",l,i,f,c,m,$,u,s,_;e=new Pe({props:{$$slots:{default:[ft]},$$scope:{ctx:a}}});function d(p){a[9](p)}let k={item:a[5]};a[4]!==void 0&&(k.setModalState=a[4]),i=new nt({props:k}),L.push(()=>H(i,"setModalState",d));function z(p){a[12](p)}let g={$$slots:{modal:[ct],button:[ut]},$$scope:{ctx:a}};return a[3]!==void 0&&(g.setDropdownState=a[3]),m=new Ke({props:g}),L.push(()=>H(m,"setDropdownState",z)),{c(){N(e.$$.fragment),n=O(),t=R("div"),o=R("button"),o.textContent=r,l=O(),N(i.$$.fragment),c=O(),N(m.$$.fragment),this.h()},l(p){F(e.$$.fragment,p),n=V(p),t=P(p,"DIV",{class:!0});var v=Q(t);o=P(v,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),ee(o)!=="svelte-gleq7e"&&(o.textContent=r),l=V(v),F(i.$$.fragment,v),c=V(v),F(m.$$.fragment,v),v.forEach(w),this.h()},h(){S(o,"class","edit-button svelte-1vu3dn8"),S(o,"type","button"),S(t,"class","menu-container svelte-1vu3dn8")},m(p,v){E(e,p,v),M(p,n,v),M(p,t,v),T(t,o),T(t,l),E(i,t,null),T(t,c),E(m,t,null),u=!0,s||(_=J(o,"click",a[8]),s=!0)},p(p,v){const K={};v&262176&&(K.$$scope={dirty:v,ctx:p}),e.$set(K);const W={};v&32&&(W.item=p[5]),!f&&v&16&&(f=!0,W.setModalState=p[4],q(()=>f=!1)),i.$set(W);const G={};v&262156&&(G.$$scope={dirty:v,ctx:p}),!$&&v&8&&($=!0,G.setDropdownState=p[3],q(()=>$=!1)),m.$set(G)},i(p){u||(B(e.$$.fragment,p),B(i.$$.fragment,p),B(m.$$.fragment,p),u=!0)},o(p){D(e.$$.fragment,p),D(i.$$.fragment,p),D(m.$$.fragment,p),u=!1},d(p){p&&(w(n),w(t)),I(e,p),I(i),I(m),s=!1,_()}}}function pt(a){let e,n,t,o=[],r=new Map,l,i;function f(u){a[13](u)}let c={};a[1]!==void 0&&(c.sortOrderValue=a[1]),e=new ze({props:c}),L.push(()=>H(e,"sortOrderValue",f));let m=pe(a[0]);const $=u=>u[15].id;for(let u=0;u<m.length;u+=1){let s=he(a,m,u),_=$(s);r.set(_,o[u]=ge(_,s))}return{c(){N(e.$$.fragment),t=O();for(let u=0;u<o.length;u+=1)o[u].c();l=Y()},l(u){F(e.$$.fragment,u),t=V(u);for(let s=0;s<o.length;s+=1)o[s].l(u);l=Y()},m(u,s){E(e,u,s),M(u,t,s);for(let _=0;_<o.length;_+=1)o[_]&&o[_].m(u,s);M(u,l,s),i=!0},p(u,s){const _={};!n&&s&2&&(n=!0,_.sortOrderValue=u[1],q(()=>n=!1)),e.$set(_),s&33&&(m=pe(u[0]),ue(),o=Ne(o,s,$,1,u,m,r,l.parentNode,Fe,ge,l,he),fe())},i(u){if(!i){B(e.$$.fragment,u);for(let s=0;s<m.length;s+=1)B(o[s]);i=!0}},o(u){D(e.$$.fragment,u);for(let s=0;s<o.length;s+=1)D(o[s]);i=!1},d(u){u&&(w(t),w(l)),I(e,u);for(let s=0;s<o.length;s+=1)o[s].d(u)}}}function _t(a){let e,n;return e=new Ve({}),{c(){N(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,o){E(e,t,o),n=!0},p:y,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){I(e,t)}}}function ht(a){let e,n;return e=new ke({}),{c(){N(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,o){E(e,t,o),n=!0},p:y,i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){I(e,t)}}}function ge(a,e){let n,t,o;return t=new Ae({props:{coffeeBeansName:e[5].name,href:U.recipeItem(e[15].id),recipe:e[15]}}),{key:a,first:null,c(){n=Y(),N(t.$$.fragment),this.h()},l(r){n=Y(),F(t.$$.fragment,r),this.h()},h(){this.first=n},m(r,l){M(r,n,l),E(t,r,l),o=!0},p(r,l){e=r;const i={};l&32&&(i.coffeeBeansName=e[5].name),l&1&&(i.href=U.recipeItem(e[15].id)),l&1&&(i.recipe=e[15]),t.$set(i)},i(r){o||(B(t.$$.fragment,r),o=!0)},o(r){D(t.$$.fragment,r),o=!1},d(r){r&&w(n),I(t,r)}}}function gt(a){let e,n,t,o,r,l;function i(s,_){return s[5]===void 0?st:s[5]==="CoffeeBeansNotFound"?ot:at}let f=i(a),c=f(a);const m=[it,lt,rt],$=[];function u(s,_){return s[5]===void 0?0:s[5]==="CoffeeBeansNotFound"?1:2}return t=u(a),o=$[t]=m[t](a),{c(){c.c(),e=Y(),n=O(),o.c(),r=Y()},l(s){const _=De("svelte-1xzg8rg",document.head);c.l(_),e=Y(),_.forEach(w),n=V(s),o.l(s),r=Y()},m(s,_){c.m(document.head,null),T(document.head,e),M(s,n,_),$[t].m(s,_),M(s,r,_),l=!0},p(s,[_]){f!==(f=i(s))&&(c.d(1),c=f(s),c&&(c.c(),c.m(e.parentNode,e)));let d=t;t=u(s),t===d?$[t].p(s,_):(ue(),D($[d],1,1,()=>{$[d]=null}),fe(),o=$[t],o?o.p(s,_):(o=$[t]=m[t](s),o.c()),B(o,1),o.m(r.parentNode,r))},i(s){l||(B(o),l=!0)},o(s){D(o),l=!1},d(s){s&&(w(n),w(r)),c.d(s),w(e),$[t].d(s)}}}function bt(a,e,n){let{data:t}=e,o,r,l,i,f,c;async function m(){if(i===void 0||i==="CoffeeBeansNotFound")return;const g=i,p=await Te(g.id);if(p==="CoffeeBeansNotFound"){le("CoffeeBeans not found in the database. Operation aborted.");return}const v=p.recipesCount===1?"recipe":"recipes",K=p.recipesCount>0?` and ${p.recipesCount} ${v}`:"";We(`Coffee beans "${g.name}"`+K+" deleted.",async()=>{await Ie(g.id),x(U.coffeeBeansItem(g.name)).then(()=>x(U.home))},async()=>{await Ee(g.id)}),x(U.home)}async function $(){const g=await ye(t.coffeeBeansName);if(g===void 0){n(5,i="CoffeeBeansNotFound");return}n(5,i=g);const p=await Re(i.id);n(0,f=p.sort(_e))}const u=()=>l("open");function s(g){l=g,n(4,l)}function _(g){o=g,n(2,o)}const d=()=>{o("open"),r("closed")};function k(g){r=g,n(3,r)}function z(g){c=g,n(1,c)}return a.$$set=g=>{"data"in g&&n(7,t=g.data)},a.$$.update=()=>{a.$$.dirty&3&&f&&n(0,f=f.sort((c==null?void 0:c.sortOrderFunc)??_e)),a.$$.dirty&128&&window.indexedDB&&$()},[f,c,o,r,l,i,m,t,u,s,_,d,k,z]}class Rt extends $e{constructor(e){super(),ve(this,e,bt,gt,be,{data:7})}}export{Rt as component,It as universal};
