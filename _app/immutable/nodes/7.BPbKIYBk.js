import{s as Ve,b as F,a as O,r as We,o as Le,c as qe}from"../chunks/scheduler.Cw1-ZcKD.js";import{S as Ee,i as Pe,v as V,e as me,k as S,s as B,c as ce,a as Ae,m as R,f as T,y as ze,d as j,z as ee,g as H,n as C,h as y,A as ie,F as Je,q as I,o as N,r as D,D as Ke,l as Ye,t as Qe,b as Xe}from"../chunks/index.D7LFJCWc.js";import{p as Ze}from"../chunks/stores.IAOmY8WK.js";import{c as xe,P as et}from"../chunks/PageHeadline.kzRusPpm.js";import{b as tt,g as fe}from"../chunks/entry.CvaJmZne.js";import{g as at}from"../chunks/manageCoffeeBeans.l_UoDZFL.js";import{n as ne}from"../chunks/naming.DmthAWfq.js";import{r as ue}from"../chunks/routes.DDLSSYwL.js";import{C as nt,F as st,N as De,a as rt,T as ot,R as it,D as ft,b as ut,p as le}from"../chunks/TextInput.DqXDoqNs.js";import{x as lt,a as pt}from"../chunks/core.D-38Eqyu.js";import{p as de,f as mt}from"../chunks/dateHelpers.c45YBD0l.js";import{T as pe}from"../chunks/Textarea.CWUpZFM_.js";async function ct({url:t}){return{coffeeBeansName:t.searchParams.get("coffee_beans_name")}}const yt=Object.freeze(Object.defineProperty({__proto__:null,load:ct},Symbol.toStringTag,{value:"Module"})),se="form_addRecipe";function dt(t){const a=JSON.stringify(t),e=localStorage.getItem(se);a!==e&&localStorage.setItem(se,a)}function gt(){const t=localStorage.getItem(se);if(t===null)return;const a=JSON.parse(t);return a.roastDate=a.roastDate?de(a.roastDate):void 0,a}function _t(){localStorage.removeItem(se)}function bt(t){let a,e,p,f,d,i,l,m,u,h;function v(s){t[23](s)}let g={};t[2]!==void 0&&(g.dateValue=t[2]),a=new it({props:g}),F.push(()=>V(a,"dateValue",v)),f=new ft({props:{daysSinceRoast:t[13],onClear:t[24]}});function w(s){t[25](s)}let $={labelText:"Bag number:",nameAttr:$t};return t[6]!==void 0&&($.value=t[6]),m=new ut({props:$}),F.push(()=>V(m,"value",w)),{c(){S(a.$$.fragment),p=B(),S(f.$$.fragment),d=B(),i=me("div"),l=B(),S(m.$$.fragment),this.h()},l(s){R(a.$$.fragment,s),p=T(s),R(f.$$.fragment,s),d=T(s),i=ce(s,"DIV",{style:!0}),Ae(i).forEach(j),l=T(s),R(m.$$.fragment,s),this.h()},h(){Ke(i,"flex-grow","1")},m(s,c){C(a,s,c),H(s,p,c),C(f,s,c),H(s,d,c),H(s,i,c),H(s,l,c),C(m,s,c),h=!0},p(s,c){const k={};!e&&c[0]&4&&(e=!0,k.dateValue=s[2],O(()=>e=!1)),a.$set(k);const b={};c[0]&8192&&(b.daysSinceRoast=s[13]),c[0]&4&&(b.onClear=s[24]),f.$set(b);const U={};!u&&c[0]&64&&(u=!0,U.value=s[6],O(()=>u=!1)),m.$set(U)},i(s){h||(I(a.$$.fragment,s),I(f.$$.fragment,s),I(m.$$.fragment,s),h=!0)},o(s){N(a.$$.fragment,s),N(f.$$.fragment,s),N(m.$$.fragment,s),h=!1},d(s){s&&(j(p),j(d),j(i),j(l)),D(a,s),D(f,s),D(m,s)}}}function ht(t){let a,e,p,f,d,i,l,m,u,h,v,g,w,$,s,c,k,b,U,W,E,z,J,P,K,Y,A,Q,X,M,te="Save",L,Z,ae;function re(n){t[20](n)}function oe(n){t[21](n)}function r(n){t[22](n)}let _={allCoffeeBeans:t[0],onSavedCoffeeBeans:t[17]};t[5]!==void 0&&(_.selectDOM=t[5]),t[1]!==void 0&&(_.selectedCoffeeBeansId=t[1]),t[4]!==void 0&&(_.setValidationFailed=t[4]),e=new nt({props:_}),F.push(()=>V(e,"selectDOM",re)),F.push(()=>V(e,"selectedCoffeeBeansId",oe)),F.push(()=>V(e,"setValidationFailed",r)),l=new st({props:{$$slots:{default:[bt]},$$scope:{ctx:t}}});function G(n){t[26](n)}let q={id:ke,label:ne.recipe.recipeTarget+":",name:ke,placeholder:le.recipeTarget};t[7]!==void 0&&(q.value=t[7]),u=new pe({props:q}),F.push(()=>V(u,"value",G));function Me(n){t[27](n)}let ge={id:Fe,label:ne.recipe.recipeResult+":",name:Fe,placeholder:le.recipeResult};t[8]!==void 0&&(ge.value=t[8]),g=new pe({props:ge}),F.push(()=>V(g,"value",Me));function je(n){t[28](n)}let _e={labelText:ne.recipe.outWeight+" (g):",min:0,nameAttr:vt,step:5};t[10]!==void 0&&(_e.value=t[10]),s=new De({props:_e}),F.push(()=>V(s,"value",je));function ye(n){t[29](n)}let be={labelText:"Rating:",max:5,min:0,nameAttr:wt,step:.5};t[11]!==void 0&&(be.value=t[11]),b=new De({props:be}),F.push(()=>V(b,"value",ye));function Ue(n){t[30](n)}let he={};t[12]!==void 0&&(he.value=t[12]),E=new rt({props:he}),F.push(()=>V(E,"value",Ue));function Ge(n){t[31](n)}let $e={id:Oe,label:ne.recipe.recipeThoughts+":",name:Oe,placeholder:le.recipeThoughts};t[9]!==void 0&&($e.value=t[9]),P=new pe({props:$e}),F.push(()=>V(P,"value",Ge));function He(n){t[32](n)}let ve={};return t[3]!==void 0&&(ve.value=t[3]),A=new ot({props:ve}),F.push(()=>V(A,"value",He)),{c(){a=me("form"),S(e.$$.fragment),i=B(),S(l.$$.fragment),m=B(),S(u.$$.fragment),v=B(),S(g.$$.fragment),$=B(),S(s.$$.fragment),k=B(),S(b.$$.fragment),W=B(),S(E.$$.fragment),J=B(),S(P.$$.fragment),Y=B(),S(A.$$.fragment),X=B(),M=me("button"),M.textContent=te,this.h()},l(n){a=ce(n,"FORM",{id:!0,class:!0});var o=Ae(a);R(e.$$.fragment,o),i=T(o),R(l.$$.fragment,o),m=T(o),R(u.$$.fragment,o),v=T(o),R(g.$$.fragment,o),$=T(o),R(s.$$.fragment,o),k=T(o),R(b.$$.fragment,o),W=T(o),R(E.$$.fragment,o),J=T(o),R(P.$$.fragment,o),Y=T(o),R(A.$$.fragment,o),X=T(o),M=ce(o,"BUTTON",{class:!0,form:!0,type:!0,"data-svelte-h":!0}),ze(M)!=="svelte-1pg8oi4"&&(M.textContent=te),o.forEach(j),this.h()},h(){ee(M,"class","bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded svelte-b37xp1"),ee(M,"form","add-recipe"),ee(M,"type","submit"),ee(a,"id","add-recipe"),ee(a,"class","svelte-b37xp1")},m(n,o){H(n,a,o),C(e,a,null),y(a,i),C(l,a,null),y(a,m),C(u,a,null),y(a,v),C(g,a,null),y(a,$),C(s,a,null),y(a,k),C(b,a,null),y(a,W),C(E,a,null),y(a,J),C(P,a,null),y(a,Y),C(A,a,null),y(a,X),y(a,M),L=!0,Z||(ae=[ie(window,"beforeunload",t[14]),ie(window,"visibilitychange",t[15]),ie(a,"submit",Je(t[16]))],Z=!0)},p(n,o){const x={};o[0]&1&&(x.allCoffeeBeans=n[0]),!p&&o[0]&32&&(p=!0,x.selectDOM=n[5],O(()=>p=!1)),!f&&o[0]&2&&(f=!0,x.selectedCoffeeBeansId=n[1],O(()=>f=!1)),!d&&o[0]&16&&(d=!0,x.setValidationFailed=n[4],O(()=>d=!1)),e.$set(x);const we={};o[0]&8260|o[1]&8&&(we.$$scope={dirty:o,ctx:n}),l.$set(we);const Se={};!h&&o[0]&128&&(h=!0,Se.value=n[7],O(()=>h=!1)),u.$set(Se);const Be={};!w&&o[0]&256&&(w=!0,Be.value=n[8],O(()=>w=!1)),g.$set(Be);const Re={};!c&&o[0]&1024&&(c=!0,Re.value=n[10],O(()=>c=!1)),s.$set(Re);const Te={};!U&&o[0]&2048&&(U=!0,Te.value=n[11],O(()=>U=!1)),b.$set(Te);const Ce={};!z&&o[0]&4096&&(z=!0,Ce.value=n[12],O(()=>z=!1)),E.$set(Ce);const Ie={};!K&&o[0]&512&&(K=!0,Ie.value=n[9],O(()=>K=!1)),P.$set(Ie);const Ne={};!Q&&o[0]&8&&(Q=!0,Ne.value=n[3],O(()=>Q=!1)),A.$set(Ne)},i(n){L||(I(e.$$.fragment,n),I(l.$$.fragment,n),I(u.$$.fragment,n),I(g.$$.fragment,n),I(s.$$.fragment,n),I(b.$$.fragment,n),I(E.$$.fragment,n),I(P.$$.fragment,n),I(A.$$.fragment,n),L=!0)},o(n){N(e.$$.fragment,n),N(l.$$.fragment,n),N(u.$$.fragment,n),N(g.$$.fragment,n),N(s.$$.fragment,n),N(b.$$.fragment,n),N(E.$$.fragment,n),N(P.$$.fragment,n),N(A.$$.fragment,n),L=!1},d(n){n&&j(a),D(e),D(l),D(u),D(g),D(s),D(b),D(E),D(P),D(A),Z=!1,We(ae)}}}const $t="bag-number",ke="recipe-target",Fe="recipe-result",Oe="recipe-thoughts",vt="out-weight",wt="rating";function St(t,a,e){let{coffeeBeansName:p}=a,f,d,i=!1,l=!1,m,u,h=new Date(0),v="",g="",w="",$="",s=0,c=0,k=!1,b=mt(new Date),U;Le(()=>{at().then(r=>{var G;e(0,m=r),p&&e(1,u=(G=m.find(q=>q.name.toLowerCase()===p.toLowerCase()))==null?void 0:G.id);const _=gt();_!==void 0&&((u===""||u===void 0)&&e(1,u=_.coffeeBeansId),e(2,h=_.roastDate??new Date(0)),e(6,v=_.bagNumber??""),e(7,g=_.recipeTarget??""),e(8,w=_.recipeResult??""),e(9,$=_.recipeThoughts??""),e(10,s=_.outWeight??0),e(11,c=_.rating??0),e(12,k=_.favorite??!1),e(19,i=!0))})}),tt(r=>{var _;r.willUnload===!1&&((_=r.to)==null?void 0:_.route.id)!=="/recipes/add"&&W()});function W(){if(l)return;dt({coffeeBeansId:u===""?void 0:u,roastDate:h,bagNumber:v,recipeTarget:g,recipeResult:w,recipeThoughts:$,outWeight:s,rating:c,favorite:k})}function E(){document.visibilityState!=="visible"&&W()}async function z(){if(u===void 0){f&&f(!0),d&&d.focus();return}e(6,v=v.trim()),e(7,g=g.trim()),e(8,w=w.trim()),e(9,$=$.trim());const r=de(b);await xe({coffeeBeansId:u,roastDate:h,bagNumber:v,recipeTarget:g,recipeResult:w,recipeThoughts:$,outWeight:s,rating:c,favorite:k,timestamp:r}),_t(),l=!0,pt("Recipe created.");const G=m.find(q=>q.id===u);if(G===void 0){fe(ue.home);return}fe(ue.coffeeBeansItem(G.name))}function J(r){m.push(r),e(1,u=r.id),f&&f(!1)}function P(r){d=r,e(5,d)}function K(r){u=r,e(1,u)}function Y(r){f=r,e(4,f)}function A(r){h=r,e(2,h)}const Q=()=>e(2,h=new Date(0));function X(r){v=r,e(6,v)}function M(r){g=r,e(7,g)}function te(r){w=r,e(8,w)}function L(r){s=r,e(10,s)}function Z(r){c=r,e(11,c)}function ae(r){k=r,e(12,k)}function re(r){$=r,e(9,$)}function oe(r){b=r,e(3,b)}return t.$$set=r=>{"coffeeBeansName"in r&&e(18,p=r.coffeeBeansName)},t.$$.update=()=>{var r;if(t.$$.dirty[0]&12&&e(13,U=lt.calculateDaysSinceRoast(de(b),h)),t.$$.dirty[0]&524291&&u&&i){const _=(r=m.find(G=>G.id===u))==null?void 0:r.name;fe(ue.addRecipe(_))}},[m,u,h,b,f,d,v,g,w,$,s,c,k,U,W,E,z,J,p,i,P,K,Y,A,Q,X,M,te,L,Z,ae,re,oe]}class Bt extends Ee{constructor(a){super(),Pe(this,a,St,ht,Ve,{coffeeBeansName:18},null,[-1,-1])}}function Rt(t){let a;return{c(){a=Qe("Add recipe")},l(e){a=Xe(e,"Add recipe")},m(e,p){H(e,a,p)},d(e){e&&j(a)}}}function Tt(t){let a,e,p,f,d;return e=new et({props:{$$slots:{default:[Rt]},$$scope:{ctx:t}}}),f=new Bt({props:{coffeeBeansName:t[0]}}),{c(){a=B(),S(e.$$.fragment),p=B(),S(f.$$.fragment),this.h()},l(i){Ye("svelte-sg0wi2",document.head).forEach(j),a=T(i),R(e.$$.fragment,i),p=T(i),R(f.$$.fragment,i),this.h()},h(){document.title="Add recipe - PourOverPotato"},m(i,l){H(i,a,l),C(e,i,l),H(i,p,l),C(f,i,l),d=!0},p(i,[l]){const m={};l&4&&(m.$$scope={dirty:l,ctx:i}),e.$set(m)},i(i){d||(I(e.$$.fragment,i),I(f.$$.fragment,i),d=!0)},o(i){N(e.$$.fragment,i),N(f.$$.fragment,i),d=!1},d(i){i&&(j(a),j(p)),D(e,i),D(f,i)}}}function Ct(t,a,e){let p;return qe(t,Ze,d=>e(1,p=d)),[p.data.coffeeBeansName]}class Ut extends Ee{constructor(a){super(),Pe(this,a,Ct,Tt,Ve,{})}}export{Ut as component,yt as universal};
